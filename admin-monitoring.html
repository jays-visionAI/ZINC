<div class="admin-card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
        <div>
            <h3 style="margin: 0;">System Monitoring</h3>
            <p style="margin: 4px 0 0 0; color: rgba(255,255,255,0.5); font-size: 14px;">Real-time agent performance &
                audit logs</p>
        </div>
        <div style="display: flex; gap: 10px;">
            <select id="monitor-range" class="admin-select" onchange="loadMonitoringData()">
                <option value="24h">Last 24 Hours</option>
                <option value="7d" selected>Last 7 Days</option>
                <option value="30d">Last 30 Days</option>
            </select>
            <button class="admin-btn-secondary" onclick="loadMonitoringData()">ðŸ”„ Refresh</button>
        </div>
    </div>

    <!-- KPI Cards -->
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
        <div class="kpi-card"
            style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);">
            <div style="font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">TOTAL RUNS</div>
            <div id="kpi-runs" style="font-size: 24px; font-weight: 700; color: #fff;">-</div>
        </div>
        <div class="kpi-card"
            style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);">
            <div style="font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">SUCCESS RATE</div>
            <div id="kpi-success" style="font-size: 24px; font-weight: 700; color: #22c55e;">-</div>
        </div>
        <div class="kpi-card"
            style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);">
            <div style="font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">AVG LATENCY</div>
            <div id="kpi-latency" style="font-size: 24px; font-weight: 700; color: #fbbf24;">-</div>
        </div>
        <div class="kpi-card"
            style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);">
            <div style="font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">EST. COST</div>
            <div id="kpi-cost" style="font-size: 24px; font-weight: 700; color: #ef4444;">-</div>
        </div>
    </div>

    <!-- Charts Row -->
    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 24px;">
        <!-- Main Chart -->
        <div
            style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.05);">
            <h4 style="margin: 0 0 20px 0; font-size: 14px; opacity: 0.7;">Execution Volume & Cost</h4>
            <div style="height: 300px; position: relative;">
                <canvas id="chart-volume"></canvas>
            </div>
        </div>

        <!-- Donut Chart -->
        <div
            style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.05);">
            <h4 style="margin: 0 0 20px 0; font-size: 14px; opacity: 0.7;">Agent Distribution</h4>
            <div style="height: 300px; position: relative; display: flex; justify-content: center;">
                <canvas id="chart-agents"></canvas>
            </div>
        </div>
    </div>

    <!-- Recent Logs Table -->
    <div class="admin-card-header" style="margin-bottom: 16px;">
        <h4 style="margin: 0;">Recent Activity Log</h4>
    </div>
    <div class="admin-table-container">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Agent</th>
                    <th>Status</th>
                    <th>Duration</th>
                    <th>Tokens</th>
                    <th>Log</th>
                </tr>
            </thead>
            <tbody id="monitoring-logs-body">
                <!-- Executed JS will populate this -->
            </tbody>
        </table>
    </div>
</div>

<!-- Log Detail Modal -->
<div id="log-detail-modal" class="admin-modal" style="display: none;">
    <div class="admin-modal-content" style="max-width: 800px; height: 80vh; display: flex; flex-direction: column;">
        <div class="admin-modal-header">
            <h3 class="admin-modal-title">Log Details</h3>
            <button class="admin-modal-close" onclick="closeLogModal()">&times;</button>
        </div>
        <div class="admin-modal-body" style="flex: 1; overflow: hidden; display: flex; flex-direction: column;">
            <div id="log-meta"
                style="margin-bottom: 16px; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px;">
            </div>
            <div style="flex: 1; position: relative;">
                <pre id="log-json"
                    style="position: absolute; top:0; left:0; right:0; bottom:0; overflow: auto; background: #0f172a; padding: 16px; border-radius: 8px; margin: 0; color: #a5b4fc; font-family: 'JetBrains Mono', monospace; font-size: 12px;"></pre>
            </div>
        </div>
    </div>
</div>