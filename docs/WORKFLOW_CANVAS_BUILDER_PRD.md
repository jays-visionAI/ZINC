# ğŸ“‹ Workflow Canvas Builder - ê°œë°œê¸°íšë¬¸ì„œ (PRD)

## 1. ê°œìš” (Overview)

### 1.1 í”„ë¡œì íŠ¸ ëª…
**Workflow Canvas Builder** - AI ê¸°ë°˜ ë¹„ì£¼ì–¼ ì›Œí¬í”Œë¡œìš° ì„¤ê³„ ë„êµ¬

### 1.2 ëª©ì 
5 Step Pipelineì˜ ê° íƒ­ ë©”ë‰´(Market Pulse, Brand Brain, Knowledge Hub, Studio, Growth)ì—ì„œ 
ë³µì¡í•œ ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°ë¥¼ **ìì—°ì–´ í”„ë¡¬í”„íŠ¸**ë¡œ ì„¤ê³„í•˜ê³ , **ìº”ë²„ìŠ¤ UI**ì—ì„œ ì„¸ë¶€ ì¡°ì • í›„, 
**ì‹¤í–‰ ê°€ëŠ¥í•œ ì½”ë“œ**ë¡œ ìë™ ë³€í™˜í•˜ëŠ” ì‹œìŠ¤í…œ êµ¬ì¶•.

### 1.3 í•µì‹¬ ê°€ì¹˜
- **No-Code/Low-Code**: ë¹„ê°œë°œìë„ ë³µì¡í•œ ì—ì´ì „íŠ¸ íŒŒì´í”„ë¼ì¸ ì„¤ê³„ ê°€ëŠ¥
- **AI ì§€ì› ì„¤ê³„**: LLMì´ ìì—°ì–´ë¥¼ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ì—ì´ì „íŠ¸ ë°°ì¹˜ ì œì•ˆ
- **ì‹œê°ì  í¸ì§‘**: ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ë…¸ë“œ ë°°ì¹˜, ì—°ê²°, ì¡°ê±´ ì„¤ì •
- **ì½”ë“œ ìë™ ìƒì„±**: ì„¤ê³„ëœ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•œ JSON/JS ì½”ë“œë¡œ ë³€í™˜

---

## 2. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ (Functional Requirements)

### 2.1 ì›Œí¬í”Œë¡œìš° ìƒì„± ë²„íŠ¼
ê° íƒ­ ìƒë‹¨ì— **"ğŸš€ Workflow ìƒì„±í•˜ê¸°"** ë²„íŠ¼ ì¶”ê°€

```
ìœ„ì¹˜: ê° íƒ­ ì½˜í…ì¸  ìƒë‹¨ (admin-card-header ë°”ë¡œ ì•„ë˜)
ìŠ¤íƒ€ì¼: ê·¸ë¼ë°ì´ì…˜ ë°°ê²½, ì•„ì´ì½˜ í¬í•¨, í˜¸ë²„ íš¨ê³¼
```

### 2.2 3ë‹¨ê³„ ì›Œí¬í”Œë¡œìš° ì„¤ê³„ í”„ë¡œì„¸ìŠ¤

#### Step 1: í”„ë¡¬í”„íŠ¸ ì…ë ¥ (Prompt Input)
| í•­ëª© | ì„¤ëª… |
|------|------|
| **ì…ë ¥ ë°©ì‹** | í…ìŠ¤íŠ¸ ì˜ì—­(Textarea)ì— ì›Œí¬í”Œë¡œìš° ì„¤ëª… ì…ë ¥ |
| **LLM ë¶„ì„** | ì…ë ¥ëœ í…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬ í•„ìš”í•œ ì—ì´ì „íŠ¸ ì‹ë³„ |
| **ìë™ ë°°ì¹˜** | í˜„ì¬ íƒ­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì—ì´ì „íŠ¸ë“¤ì„ ìº”ë²„ìŠ¤ì— ìë™ ë°°ì¹˜ |
| **ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸** | "ê³ ê° ë°ì´í„°ë¥¼ ë¶„ì„í•´ì„œ íŠ¸ë Œë“œë¥¼ íŒŒì•…í•˜ê³ , ê²½ìŸì‚¬ ë¶„ì„ì„ ë³‘ë ¬ë¡œ ì§„í–‰í•œ í›„, ê·¸ ê²°ê³¼ë¥¼ í•©ì³ì„œ ì „ëµ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì¤˜" |

#### Step 2: ìº”ë²„ìŠ¤ í¸ì§‘ (Canvas Editor)
| í•­ëª© | ì„¤ëª… |
|------|------|
| **ë…¸ë“œ ìœ í˜•** | Start, Agent, Condition, Merge, End |
| **ì—°ê²° ë°©ì‹** | ë“œë˜ê·¸ë¡œ ë…¸ë“œ ê°„ ì—°ê²°ì„  ìƒì„± |
| **ë°°ì¹˜ ì˜µì…˜** | ìˆœì°¨(Sequential) / ë³‘ë ¬(Parallel) / ì¡°ê±´ë¶€(Conditional) |
| **ì¡°ê±´ ì„¤ì •** | IF/ELSE, Switch-Case, Loop, Error Handling |
| **ì†ì„± í¸ì§‘** | ê° ë…¸ë“œ í´ë¦­ ì‹œ ìš°ì¸¡ íŒ¨ë„ì—ì„œ ìƒì„¸ ì„¤ì • |

#### Step 3: ì½”ë“œ ìƒì„± (Code Generation)
| í•­ëª© | ì„¤ëª… |
|------|------|
| **ì¶œë ¥ í˜•ì‹** | JSON (ì›Œí¬í”Œë¡œìš° ì •ì˜) + JavaScript (ì‹¤í–‰ ì½”ë“œ) |
| **ì €ì¥ ìœ„ì¹˜** | Firestore `workflowDefinitions` ì»¬ë ‰ì…˜ |
| **ì‹¤í–‰ ë°©ì‹** | ì €ì¥ëœ ì›Œí¬í”Œë¡œìš°ëŠ” DAG Executorì—ì„œ ì‹¤í–‰ ê°€ëŠ¥ |

---

## 3. ë…¸ë“œ ìœ í˜• ìƒì„¸ (Node Types)

### 3.1 Start Node (ì‹œì‘ ë…¸ë“œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â— START      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚   Input: {...}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- **ì—­í• **: ì›Œí¬í”Œë¡œìš° ì§„ì…ì 
- **ì†ì„±**: 
  - `inputSchema`: ì…ë ¥ ë°ì´í„° ìŠ¤í‚¤ë§ˆ ì •ì˜
  - `triggerType`: manual | scheduled | event-driven
  - `description`: ì›Œí¬í”Œë¡œìš° ì„¤ëª…

### 3.2 Agent Node (ì—ì´ì „íŠ¸ ë…¸ë“œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– AgentName    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  Model: GPT-4o   â”‚
â”‚  Temp: 0.7       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- **ì—­í• **: íŠ¹ì • ì—ì´ì „íŠ¸ ì‹¤í–‰
- **ì†ì„±**:
  - `agentId`: ì—ì´ì „íŠ¸ ID (Firestore ì°¸ì¡°)
  - `agentType`: research | planner | creator | etc.
  - `model`: ì‚¬ìš©í•  LLM ëª¨ë¸
  - `temperature`: ì˜¨ë„ ì„¤ì •
  - `maxTokens`: ìµœëŒ€ í† í°
  - `inputMapping`: ì´ì „ ë…¸ë“œ ì¶œë ¥ì„ ì…ë ¥ìœ¼ë¡œ ë§¤í•‘
  - `outputKey`: ì¶œë ¥ ë³€ìˆ˜ëª…

### 3.3 Condition Node (ì¡°ê±´ ë…¸ë“œ)
```
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ IF/ELSE â”‚
       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
    â–¼       â–¼       â–¼
  TRUE   FALSE   DEFAULT
```
- **ì—­í• **: ì¡°ê±´ì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬
- **ì†ì„±**:
  - `conditionType`: if-else | switch | loop
  - `expression`: ì¡°ê±´ì‹ (JavaScript í‘œí˜„ì‹)
  - `branches`: ë¶„ê¸°ë³„ ì—°ê²° ì •ë³´
  - `defaultBranch`: ê¸°ë³¸ ë¶„ê¸°

**ì¡°ê±´ ìœ í˜• ìƒì„¸:**
| ìœ í˜• | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| `IF-ELSE` | ì´ì§„ ë¶„ê¸° | `output.score > 80` |
| `SWITCH` | ë‹¤ì¤‘ ë¶„ê¸° | `output.category === 'A'` |
| `LOOP` | ë°˜ë³µ ì‹¤í–‰ | `items.forEach(...)` |
| `WAIT` | ì¡°ê±´ ëŒ€ê¸° | `await approval === true` |

### 3.4 Parallel Gateway (ë³‘ë ¬ ê²Œì´íŠ¸ì›¨ì´)
```
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”
          â”‚ SPLIT â”‚
          â””â”€â”€â”€â”¬â”€â”€â”€â”˜
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
      â–¼       â–¼       â–¼
   Agent1  Agent2  Agent3
      â”‚       â”‚       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
          â”Œâ”€â”€â”€â”´â”€â”€â”€â”
          â”‚ MERGE â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”˜
```
- **ì—­í• **: ë³‘ë ¬ ì‹¤í–‰ ë° ê²°ê³¼ í•©ì¹˜ê¸°
- **ì†ì„±**:
  - `parallelType`: split | merge
  - `mergeStrategy`: all | any | race
  - `timeout`: íƒ€ì„ì•„ì›ƒ ì„¤ì •

### 3.5 End Node (ì¢…ë£Œ ë…¸ë“œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      â–  END       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚   Output: {...}   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- **ì—­í• **: ì›Œí¬í”Œë¡œìš° ì¢…ë£Œ ë° ìµœì¢… ì¶œë ¥
- **ì†ì„±**:
  - `outputSchema`: ìµœì¢… ì¶œë ¥ ìŠ¤í‚¤ë§ˆ
  - `successHandler`: ì„±ê³µ ì‹œ ì²˜ë¦¬
  - `errorHandler`: ì˜¤ë¥˜ ì‹œ ì²˜ë¦¬

---

## 4. UI/UX ìƒì„¸ ì„¤ê³„

### 4.1 ë©”ì¸ ë ˆì´ì•„ì›ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [â† Back to Pipeline]     Workflow Canvas Builder      [Save] [Run]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Prompt  â”‚  Step 2: Canvas  â”‚  Step 3: Code  â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                          â”‚  â”‚ Properties  â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚             CANVAS AREA                  â”‚  â”‚ Node Type:  â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚ Agent       â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚             â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚ Model:      â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚ [GPT-4o  â–¼] â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚             â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚ Temp: [0.7] â”‚ â”‚
â”‚  â”‚                                          â”‚  â”‚             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Available Agents: [Research] [Planner] [Creator] [+Custom]  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ìº”ë²„ìŠ¤ ì¸í„°ë™ì…˜
| ë™ì‘ | ì„¤ëª… |
|------|------|
| **ë“œë˜ê·¸** | ë…¸ë“œ ìœ„ì¹˜ ì´ë™ |
| **ë”ë¸”í´ë¦­** | ë…¸ë“œ ì†ì„± í¸ì§‘ ëª¨ë‹¬ ì˜¤í”ˆ |
| **ìš°í´ë¦­** | ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ (ì‚­ì œ, ë³µì œ, ê·¸ë£¹í™”) |
| **Shift+ë“œë˜ê·¸** | ë‹¤ì¤‘ ì„ íƒ |
| **ë§ˆìš°ìŠ¤íœ ** | ì¤Œ ì¸/ì•„ì›ƒ |
| **ìŠ¤í˜ì´ìŠ¤+ë“œë˜ê·¸** | ìº”ë²„ìŠ¤ íŒ¨ë‹ |

### 4.3 ë…¸ë“œ ì—°ê²°
```
[ë…¸ë“œ A] - - - - â†’ [ë…¸ë“œ B]
          â”‚
          â”‚ í¬íŠ¸ì—ì„œ ë“œë˜ê·¸ ì‹œì‘
          â”‚ ëŒ€ìƒ ë…¸ë“œì˜ ì…ë ¥ í¬íŠ¸ì— ë“œë¡­
          â”‚ ì—°ê²°ì„  ìŠ¤íƒ€ì¼: ë² ì§€ì–´ ê³¡ì„ 
          â””â†’ ì¡°ê±´ ë…¸ë“œ: ë¶„ê¸°ë³„ ìƒ‰ìƒ êµ¬ë¶„
              â€¢ TRUE: ë…¹ìƒ‰
              â€¢ FALSE: ë¹¨ê°„ìƒ‰
              â€¢ DEFAULT: íšŒìƒ‰
```

### 4.4 í”„ë¡¬í”„íŠ¸ ë¶„ì„ UI (Step 1)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ ì›Œí¬í”Œë¡œìš°ë¥¼ ìì—°ì–´ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  [                                                              ]â”‚
â”‚  [  ì˜ˆ: "ë¨¼ì € íŠ¸ë Œë“œë¥¼ ë¶„ì„í•˜ê³ , ê²°ê³¼ê°€ ìœ ì˜ë¯¸í•˜ë©´                ] â”‚
â”‚  [  ì½˜í…ì¸  ê¸°íšì„ ì§„í–‰í•˜ê³ , ì•„ë‹ˆë©´ ì¶”ê°€ ë¦¬ì„œì¹˜ë¥¼ í•´ì¤˜"            ] â”‚
â”‚  [                                                              ]â”‚
â”‚                                                                  â”‚
â”‚         [ğŸ”® AIë¡œ ì›Œí¬í”Œë¡œìš° ìƒì„±]        [ğŸ“‹ í…œí”Œë¦¿ ì„ íƒ]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– AI ë¶„ì„ ê²°ê³¼                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ê°ì§€ëœ ì—ì´ì „íŠ¸:                                                â”‚
â”‚  âœ… Trend Researcher                                            â”‚
â”‚  âœ… Strategic Planner                                           â”‚
â”‚  âœ… Content Creator                                             â”‚
â”‚                                                                  â”‚
â”‚  ê°ì§€ëœ íë¦„:                                                    â”‚
â”‚  â€¢ ìˆœì°¨ ì‹¤í–‰: Trend â†’ [ì¡°ê±´ ë¶„ê¸°]                                 â”‚
â”‚  â€¢ ì¡°ê±´ A (ìœ ì˜ë¯¸): Planner â†’ Creator                            â”‚
â”‚  â€¢ ì¡°ê±´ B (ë¯¸ë‹¬): Trend (ì¬ì‹¤í–‰)                                  â”‚
â”‚                                                                  â”‚
â”‚         [âœ¨ ìº”ë²„ìŠ¤ì— ì ìš©]        [âœï¸ ìˆ˜ì • ìš”ì²­]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. ë°ì´í„° ëª¨ë¸

### 5.1 Workflow Definition Schema
```javascript
// Firestore: workflowDefinitions/{workflowId}
{
  id: "wf_abc123",
  name: "íŠ¸ë Œë“œ ê¸°ë°˜ ì½˜í…ì¸  ìƒì„± íŒŒì´í”„ë¼ì¸",
  description: "íŠ¸ë Œë“œ ë¶„ì„ í›„ ì¡°ê±´ì— ë”°ë¼ ì½˜í…ì¸  ìƒì„±",
  pipelineContext: "market",  // market | brand | knowledge | studio | growth
  version: "1.0.0",
  status: "draft",  // draft | active | archived
  
  // ë…¸ë“œ ì •ì˜
  nodes: [
    {
      id: "node_start",
      type: "start",
      position: { x: 100, y: 200 },
      data: {
        inputSchema: { type: "object", properties: { topic: { type: "string" } } },
        triggerType: "manual"
      }
    },
    {
      id: "node_research",
      type: "agent",
      position: { x: 300, y: 200 },
      data: {
        agentId: "agent_trend_researcher",
        agentType: "research",
        model: "gpt-4o",
        temperature: 0.7,
        inputMapping: { "topic": "{{start.input.topic}}" },
        outputKey: "researchResult"
      }
    },
    {
      id: "node_condition",
      type: "condition",
      position: { x: 500, y: 200 },
      data: {
        conditionType: "if-else",
        expression: "researchResult.confidence > 0.7",
        branches: {
          true: "node_planner",
          false: "node_research_retry"
        }
      }
    },
    {
      id: "node_planner",
      type: "agent",
      position: { x: 700, y: 100 },
      data: {
        agentId: "agent_strategic_planner",
        agentType: "planner",
        model: "gpt-4o",
        temperature: 0.5
      }
    },
    {
      id: "node_end",
      type: "end",
      position: { x: 900, y: 200 },
      data: {
        outputSchema: { type: "object" }
      }
    }
  ],
  
  // ì—°ê²° ì •ì˜
  edges: [
    { id: "e1", source: "node_start", target: "node_research" },
    { id: "e2", source: "node_research", target: "node_condition" },
    { id: "e3", source: "node_condition", target: "node_planner", label: "TRUE" },
    { id: "e4", source: "node_planner", target: "node_end" }
  ],
  
  // ë©”íƒ€ë°ì´í„°
  createdAt: Timestamp,
  updatedAt: Timestamp,
  createdBy: "user_abc",
  projectId: "project_xyz"
}
```

### 5.2 Workflow Execution Schema
```javascript
// Firestore: workflowExecutions/{executionId}
{
  id: "exec_123",
  workflowId: "wf_abc123",
  status: "running",  // pending | running | completed | failed
  startedAt: Timestamp,
  completedAt: null,
  
  // ì‹¤í–‰ ì¤‘ ë…¸ë“œë³„ ìƒíƒœ
  nodeStates: {
    "node_start": { status: "completed", output: {...} },
    "node_research": { status: "running", startedAt: Timestamp },
    "node_condition": { status: "pending" }
  },
  
  // ì‹¤í–‰ ë¡œê·¸
  logs: [
    { timestamp: Timestamp, nodeId: "node_start", message: "Started", level: "info" }
  ],
  
  // ìµœì¢… ì¶œë ¥
  finalOutput: null,
  error: null
}
```

---

## 6. ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜

### 6.1 í”„ë¡ íŠ¸ì—”ë“œ
| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **Vanilla JS** | ë©”ì¸ ë¡œì§ |
| **Canvas API / SVG** | ìº”ë²„ìŠ¤ ë Œë”ë§ |
| **interact.js** | ë“œë˜ê·¸ ì•¤ ë“œë¡­ |
| **leader-line** | ë…¸ë“œ ì—°ê²°ì„  |

### 6.2 ë°±ì—”ë“œ
| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **Cloud Functions** | LLM í”„ë¡¬í”„íŠ¸ ë¶„ì„ API |
| **Firestore** | ì›Œí¬í”Œë¡œìš° ì •ì˜ ì €ì¥ |
| **DAG Executor** | ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì—”ì§„ |

### 6.3 LLM í†µí•©
```javascript
// í”„ë¡¬í”„íŠ¸ ë¶„ì„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
const WORKFLOW_ANALYZER_PROMPT = `
You are a workflow design assistant. Analyze the user's natural language description
and output a structured workflow definition.

Available agents for "${pipelineContext}" context:
${availableAgents.map(a => `- ${a.name}: ${a.description}`).join('\n')}

Output format:
{
  "detectedAgents": [...],
  "flowType": "sequential" | "parallel" | "conditional",
  "steps": [...],
  "conditions": [...],
  "confidence": 0.0-1.0
}
`;
```

---

## 7. êµ¬í˜„ ë¡œë“œë§µ

### Phase 1: ê¸°ë°˜ êµ¬ì¶• (Week 1-2)
- [ ] ëª¨ë‹¬ UI êµ¬í˜„ (Workflow Canvas Builder ì˜¤ë²„ë ˆì´)
- [ ] ìº”ë²„ìŠ¤ ê¸°ë³¸ ë Œë”ë§ (SVG ê¸°ë°˜)
- [ ] ë…¸ë“œ ë“œë˜ê·¸ ì•¤ ë“œë¡­
- [ ] ë…¸ë“œ ì—°ê²°ì„  êµ¬í˜„

### Phase 2: í”„ë¡¬í”„íŠ¸ ë¶„ì„ (Week 2-3)
- [ ] LLM í”„ë¡¬í”„íŠ¸ ë¶„ì„ Cloud Function
- [ ] ë¶„ì„ ê²°ê³¼ â†’ ìº”ë²„ìŠ¤ ë…¸ë“œ ìë™ ìƒì„±
- [ ] ì—ì´ì „íŠ¸ ë§¤í•‘ ë¡œì§

### Phase 3: ì¡°ê±´/ë¶„ê¸° ì²˜ë¦¬ (Week 3-4)
- [ ] IF/ELSE ë…¸ë“œ êµ¬í˜„
- [ ] ë³‘ë ¬ ê²Œì´íŠ¸ì›¨ì´ (Split/Merge)
- [ ] ì†ì„± í¸ì§‘ íŒ¨ë„
- [ ] ì¡°ê±´ì‹ ì…ë ¥ UI

### Phase 4: ì½”ë“œ ìƒì„± & ì €ì¥ (Week 4-5)
- [ ] ìº”ë²„ìŠ¤ â†’ JSON ë³€í™˜
- [ ] Firestore ì €ì¥ ë¡œì§
- [ ] ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì—°ë™ (DAG Executor)
- [ ] ë²„ì „ ê´€ë¦¬

### Phase 5: ê³ ê¸‰ ê¸°ëŠ¥ (Week 5-6)
- [ ] í…œí”Œë¦¿ ë¼ì´ë¸ŒëŸ¬ë¦¬
- [ ] ì‹¤í–‰ ëª¨ë‹ˆí„°ë§ ì‹¤ì‹œê°„ í‘œì‹œ
- [ ] ì˜¤ë¥˜ ì²˜ë¦¬ ë…¸ë“œ
- [ ] ì›Œí¬í”Œë¡œìš° ê³µìœ /ë‚´ë³´ë‚´ê¸°

---

## 8. íŒŒì¼ êµ¬ì¡°

```
/Users/sangjaeseo/Antigravity/ZINC/
â”œâ”€â”€ admin-pipeline.html              # (ìˆ˜ì •) ì›Œí¬í”Œë¡œìš° ë²„íŠ¼ ì¶”ê°€
â”œâ”€â”€ admin-pipeline.js                # (ìˆ˜ì •) ëª¨ë‹¬ í˜¸ì¶œ ë¡œì§
â”œâ”€â”€ workflow-canvas/                 # (ì‹ ê·œ) ì›Œí¬í”Œë¡œìš° ìº”ë²„ìŠ¤ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ workflow-canvas.html         # ìº”ë²„ìŠ¤ HTML êµ¬ì¡°
â”‚   â”œâ”€â”€ workflow-canvas.css          # ìº”ë²„ìŠ¤ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ workflow-canvas.js           # ìº”ë²„ìŠ¤ ë©”ì¸ ë¡œì§
â”‚   â”œâ”€â”€ nodes/                       # ë…¸ë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ start-node.js
â”‚   â”‚   â”œâ”€â”€ agent-node.js
â”‚   â”‚   â”œâ”€â”€ condition-node.js
â”‚   â”‚   â”œâ”€â”€ parallel-node.js
â”‚   â”‚   â””â”€â”€ end-node.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ canvas-renderer.js       # ìº”ë²„ìŠ¤ ë Œë”ë§
â”‚   â”‚   â”œâ”€â”€ connection-manager.js    # ì—°ê²°ì„  ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ workflow-serializer.js   # JSON ì§ë ¬í™”
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ workflow-analyzer.js     # LLM ë¶„ì„ ì„œë¹„ìŠ¤
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ workflow-analyzer-service.js  # í”„ë¡¬í”„íŠ¸ ë¶„ì„ Cloud Function
â””â”€â”€ docs/
    â””â”€â”€ WORKFLOW_CANVAS_BUILDER_PRD.md   # ì´ ë¬¸ì„œ
```

---

## 9. API ëª…ì„¸

### 9.1 ì›Œí¬í”Œë¡œìš° ë¶„ì„ API
```javascript
// POST /analyzeWorkflowPrompt
{
  prompt: "íŠ¸ë Œë“œë¥¼ ë¶„ì„í•´ì„œ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ì–´ì¤˜",
  pipelineContext: "market",
  projectId: "proj_123"
}

// Response
{
  success: true,
  analysis: {
    detectedAgents: ["research", "planner", "creator"],
    suggestedFlow: { nodes: [...], edges: [...] },
    confidence: 0.85,
    clarificationNeeded: []
  }
}
```

### 9.2 ì›Œí¬í”Œë¡œìš° ì €ì¥ API
```javascript
// POST /saveWorkflowDefinition
{
  workflowId: null,  // null = ì‹ ê·œ ìƒì„±
  definition: { nodes: [...], edges: [...] },
  name: "My Workflow",
  pipelineContext: "market"
}

// Response
{
  success: true,
  workflowId: "wf_abc123",
  version: "1.0.0"
}
```

### 9.3 ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ API
```javascript
// POST /executeWorkflow
{
  workflowId: "wf_abc123",
  input: { topic: "AI íŠ¸ë Œë“œ" }
}

// Response
{
  success: true,
  executionId: "exec_456",
  status: "started"
}
```

---

## 10. ì˜ˆìƒ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë§ˆì¼€í„°ì˜ ì½˜í…ì¸  ì›Œí¬í”Œë¡œìš° ìƒì„±
```
1. Market Pulse íƒ­ì—ì„œ "Workflow ìƒì„±í•˜ê¸°" í´ë¦­
2. í”„ë¡¬í”„íŠ¸ ì…ë ¥: "ê²½ìŸì‚¬ ë¶„ì„ê³¼ íŠ¸ë Œë“œ ë¦¬ì„œì¹˜ë¥¼ ë™ì‹œì— í•˜ê³ , 
   ë‘˜ ë‹¤ ì™„ë£Œë˜ë©´ ê²°ê³¼ë¥¼ í•©ì³ì„œ ë³´ê³ ì„œ ìƒì„±"
3. AIê°€ ë¶„ì„í•˜ì—¬ ìº”ë²„ìŠ¤ì— ìë™ ë°°ì¹˜:
   [Start] â†’ [Parallel Split] â†’ [Competitor Agent] 
                              â†’ [Trend Agent]
           â†’ [Parallel Merge] â†’ [Report Agent] â†’ [End]
4. í•„ìš” ì‹œ ì¡°ê±´ ì¶”ê°€: "ì‹ ë¢°ë„ 80% ì´ìƒì¼ ë•Œë§Œ ë³´ê³ ì„œ ìƒì„±"
5. ì €ì¥ í›„ ë°”ë¡œ ì‹¤í–‰
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ê°œë°œìì˜ ë³µì¡í•œ íŒŒì´í”„ë¼ì¸ ì„¤ê³„
```
1. Studio íƒ­ì—ì„œ "Workflow ìƒì„±í•˜ê¸°" í´ë¦­
2. ì§ì ‘ ìº”ë²„ìŠ¤ì— ë…¸ë“œ ë°°ì¹˜ (í”„ë¡¬í”„íŠ¸ ì—†ì´)
3. ì¡°ê±´ ë…¸ë“œ ì¶”ê°€: 
   - IF output.format === 'image' â†’ Visual Creator
   - IF output.format === 'text' â†’ Text Producer
   - ELSE â†’ Orchestrator (ì¬ë¶„ì„)
4. ì˜¤ë¥˜ ì²˜ë¦¬ ë…¸ë“œ ì¶”ê°€: ì—ëŸ¬ ë°œìƒ ì‹œ Slack ì•Œë¦¼
5. JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸° í›„ CI/CD ì—°ë™
```

---

## 11. ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

| í•­ëª© | ëª©í‘œì¹˜ | ë¹„ê³  |
|------|--------|------|
| ìº”ë²„ìŠ¤ ë Œë”ë§ | < 100ms | ë…¸ë“œ 100ê°œ ê¸°ì¤€ |
| í”„ë¡¬í”„íŠ¸ ë¶„ì„ | < 3s | LLM ì‘ë‹µ ì‹œê°„ í¬í•¨ |
| ì½”ë“œ ìƒì„± | < 500ms | í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ |
| ì›Œí¬í”Œë¡œìš° ì €ì¥ | < 1s | Firestore ì“°ê¸° |

---

## 12. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- [ ] ì¡°ê±´ì‹ ì…ë ¥ ì‹œ ì•…ì„± ì½”ë“œ ì‹¤í–‰ ë°©ì§€ (sandbox ì‹¤í–‰)
- [ ] ì›Œí¬í”Œë¡œìš° ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬ (í”„ë¡œì íŠ¸ë³„)
- [ ] API í‚¤/ì‹œí¬ë¦¿ì´ ì¡°ê±´ì‹ì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ì²˜ë¦¬
- [ ] ì‹¤í–‰ ë¡œê·¸ì—ì„œ ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹

---

## 13. í–¥í›„ í™•ì¥ ê³„íš

### v2.0 - í˜‘ì—… ê¸°ëŠ¥
- ì‹¤ì‹œê°„ ë‹¤ì¤‘ ì‚¬ìš©ì í¸ì§‘ (CRDT ê¸°ë°˜)
- ì›Œí¬í”Œë¡œìš° ë²„ì „ íˆìŠ¤í† ë¦¬
- ì½”ë©˜íŠ¸ ë° ë¦¬ë·° ê¸°ëŠ¥

### v3.0 - ë§ˆì¼“í”Œë ˆì´ìŠ¤
- ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ë§ˆì¼“
- ì»¤ìŠ¤í…€ ë…¸ë“œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ
- ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™ ë…¸ë“œ (Zapier, Make ë“±)

---

## 14. ì„±ê³µ ì§€í‘œ (KPI)

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|----------|
| ì›Œí¬í”Œë¡œìš° ìƒì„± ìˆ˜ | ì›” 100+ | Firestore ë¬¸ì„œ ìˆ˜ |
| í”„ë¡¬í”„íŠ¸ â†’ ìº”ë²„ìŠ¤ ì„±ê³µë¥  | 80%+ | ìˆ˜ì • ì—†ì´ ì‹¤í–‰ ë¹„ìœ¨ |
| í‰ê·  ì„¤ê³„ ì‹œê°„ | < 10ë¶„ | ìƒì„±~ì €ì¥ ì‹œê°„ ì¸¡ì • |
| ì¬ì‚¬ìš©ë¥  | 30%+ | í…œí”Œë¦¿ ì‚¬ìš© ë¹„ìœ¨ |

---

## ë¶€ë¡ A: ìš©ì–´ ì •ì˜

| ìš©ì–´ | ì •ì˜ |
|------|------|
| **Node** | ì›Œí¬í”Œë¡œìš°ì˜ ë‹¨ìœ„ ì‹¤í–‰ ë¸”ë¡ |
| **Edge** | ë…¸ë“œ ê°„ ì—°ê²° (ì‹¤í–‰ ìˆœì„œ) |
| **Port** | ë…¸ë“œì˜ ì…ì¶œë ¥ ì—°ê²°ì  |
| **Gateway** | ë³‘ë ¬/ì¡°ê±´ ë¶„ê¸°ë¥¼ ì²˜ë¦¬í•˜ëŠ” íŠ¹ìˆ˜ ë…¸ë“œ |
| **DAG** | Directed Acyclic Graph (ë°©í–¥ì„± ë¹„ìˆœí™˜ ê·¸ë˜í”„) |

---

**ì‘ì„±ì¼**: 2026-01-06  
**ì‘ì„±ì**: Antigravity AI  
**ë²„ì „**: 1.0.0  
**ìƒíƒœ**: Draft  
