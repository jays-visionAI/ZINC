# ZINC 콘텐츠 생성 컨텍스트 아키텍처 및 개선 기획안

## 1. 현재 콘텐츠 생성 컨텍스트 상세 분석

### 1.1 기본 컨텍스트 구성 요소

현재 `executeSubAgent` Cloud Function에서 사용하는 컨텍스트:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     ENHANCED SYSTEM PROMPT COMPOSITION                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────────┐                                                  │
│  │   1. PROJECT CONTEXT   │ ◄── projects/{projectId}                         │
│  │   ─────────────────    │                                                  │
│  │   • name               │  프로젝트 이름                                    │
│  │   • description        │  프로젝트 설명                                    │
│  │   • targetAudience     │  타겟 오디언스                                    │
│  │   • industry           │  산업 분류                                        │
│  └────────────────────────┘                                                  │
│              │                                                               │
│              ▼                                                               │
│  ┌────────────────────────┐                                                  │
│  │   2. BRAND PROFILE     │ ◄── brandBrain/{userId}/projects/{projectId}      │
│  │   ─────────────────    │                                                  │
│  │   • persona            │  브랜드 페르소나 (예: Professional, Friendly)       │
│  │   • tone               │  커뮤니케이션 톤 (Formal ↔ Casual 슬라이더)        │
│  │   • values             │  핵심 가치 (예: Innovation, Trust)                 │
│  │   • voiceStyle[]       │  보이스 스타일 태그 배열                           │
│  │   • doList[]           │  Do's - 권장 사항                                  │
│  │   • dontList[]         │  Don'ts - 금지 사항                                │
│  └────────────────────────┘                                                  │
│              │                                                               │
│              ▼                                                               │
│  ┌────────────────────────┐                                                  │
│  │ 3. KNOWLEDGE BASE      │ ◄── projects/{projectId}/knowledgeSources        │
│  │   ─────────────────    │                                                  │
│  │   • title              │  문서 제목                                        │
│  │   • content (500자)    │  문서 내용 (앞 500자만 사용)                       │
│  │   • summary            │  AI 생성 요약                                      │
│  │   • type               │  문서 유형 (PDF, Link, Note, Drive)               │
│  │   • (최대 5개)         │  active=true인 문서 5개 제한                       │
│  └────────────────────────┘                                                  │
│              │                                                               │
│              ▼                                                               │
│  ┌────────────────────────┐                                                  │
│  │ 4. TECHNICAL REQS      │ ◄── 조건부 (Designer 에이전트만)                   │
│  │   ─────────────────    │                                                  │
│  │   • A4 PDF 규격        │  210mm x 297mm                                    │
│  │   • Print CSS          │  인쇄 안정성 CSS                                   │
│  │   • HTML 단독 출력     │  마크다운/대화 금지                                │
│  └────────────────────────┘                                                  │
│              │                                                               │
│              ▼                                                               │
│  ┌────────────────────────┐                                                  │
│  │ 5. PREVIOUS OUTPUTS    │ ◄── 런타임 전달 (previousOutputs[])               │
│  │   ─────────────────    │                                                  │
│  │   • 이전 에이전트 출력 │  팀 내 에이전트 협업 시 사용                       │
│  │   • 역할 + 내용 결합   │                                                  │
│  └────────────────────────┘                                                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 현재 데이터 흐름

```
Firestore Collections
━━━━━━━━━━━━━━━━━━━━━

projects/{projectId}
├── name, description, targetAudience, industry
├── competitors[]                    ← Market Pulse 경쟁사
├── marketPulseKeywords[]            ← 모니터링 키워드
├── competitorBriefing               ← 경쟁사 분석 정보
│
├── /knowledgeSources/{sourceId}     ← Knowledge Hub 문서
│   ├── title, content, summary
│   ├── type (pdf, link, note, drive)
│   └── active: boolean
│
├── /generatedContents/{contentId}   ← 생성된 콘텐츠
├── /agentRuns/{runId}               ← 실행 기록
└── /marketPulse/{docId}             ← 시장 분석 데이터

brandBrain/{userId}
├── (루트 레벨 기본 설정)
└── /projects/{projectId}
    ├── persona, tone, values
    ├── voiceStyle[], doList[], dontList[]
    ├── keywords[]
    ├── strategy { currentFocus }
    └── /sources/{sourceId}          ← 브랜드 소스 (Drive, Links, Notes)
```

---

## 2. 점수 기반 컴포넌트 시스템 기획

### 2.1 두 가지 핵심 점수 체계

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        SCORE-BASED SERVICE TIERS                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────────────────────┐    ┌─────────────────────────────┐        │
│   │    KNOWLEDGE SCORE 📚       │    │    BRAND HEALTH SCORE 💪    │        │
│   │    (데이터 충실도)          │    │    (브랜드 정의 완성도)      │        │
│   ├─────────────────────────────┤    ├─────────────────────────────┤        │
│   │ 측정 항목:                  │    │ 측정 항목:                  │        │
│   │ • Knowledge Hub 문서 수     │    │ • Core Identity (30점)      │        │
│   │ • 문서 품질 (길이/상세도)   │    │ • Strategy (25점)           │        │
│   │ • 문서 다양성 (유형별)      │    │ • Knowledge Base (25점)     │        │
│   │ • 최신성 (마지막 업데이트)  │    │ • Update Frequency (10점)   │        │
│   │ • AI 요약 유무              │    │ • Quality Metrics (10점)    │        │
│   ├─────────────────────────────┤    ├─────────────────────────────┤        │
│   │ 영향:                       │    │ 영향:                       │        │
│   │ • AI 응답 정확도            │    │ • 콘텐츠 브랜드 일관성      │        │
│   │ • 컨텍스트 깊이             │    │ • 톤/스타일 정밀도          │        │
│   │ • 할루시네이션 감소         │    │ • 차별화된 콘텐츠           │        │
│   └─────────────────────────────┘    └─────────────────────────────┘        │
│                  │                              │                           │
│                  └──────────────┬───────────────┘                           │
│                                 ▼                                           │
│                    ┌─────────────────────────────┐                          │
│                    │    COMBINED READINESS       │                          │
│                    │    ──────────────────       │                          │
│                    │  0-30:  🌱 시작 단계        │                          │
│                    │  31-50: 🌿 준비 완료        │                          │
│                    │  51-80: 🌳 프로              │                          │
│                    │  81-100: 🏆 마스터           │                          │
│                    └─────────────────────────────┘                          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 컴포넌트 기반 컨텍스트 모듈

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    MODULAR CONTEXT COMPONENT SYSTEM                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────── BASIC TIER (점수 0-30) ───────────────┐                   │
│  │                                                       │                   │
│  │  [✓] Core Identity Component                          │                   │
│  │      └─ projectName, industry, description            │                   │
│  │                                                       │                   │
│  │  [✓] Basic Prompt Component                           │                   │
│  │      └─ 기본 시스템 프롬프트                          │                   │
│  │                                                       │                   │
│  └───────────────────────────────────────────────────────┘                   │
│                          │                                                   │
│                          ▼ 점수 31+ 달성 시 언락                             │
│  ┌─────────────── STANDARD TIER (점수 31-50) ───────────┐                   │
│  │                                                       │                   │
│  │  [+] Brand Voice Component                            │                   │
│  │      └─ persona, tone, voiceStyle[]                   │                   │
│  │                                                       │                   │
│  │  [+] Target Audience Component                        │                   │
│  │      └─ targetAudience, region, demographics          │                   │
│  │                                                       │                   │
│  │  [+] Basic Knowledge Component                        │                   │
│  │      └─ knowledgeSources (3개 제한)                   │                   │
│  │                                                       │                   │
│  └───────────────────────────────────────────────────────┘                   │
│                          │                                                   │
│                          ▼ 점수 51+ 달성 시 언락                             │
│  ┌─────────────── PRO TIER (점수 51-80) ────────────────┐                   │
│  │                                                       │                   │
│  │  [+] Advanced Knowledge Component                     │                   │
│  │      └─ knowledgeSources (10개 확장)                  │                   │
│  │      └─ AI 요약 + 핵심 인사이트 주입                  │                   │
│  │                                                       │                   │
│  │  [+] Brand Guidelines Component                       │                   │
│  │      └─ doList[], dontList[], keywords[]              │                   │
│  │                                                       │                   │
│  │  [+] Competitor Intelligence Component                │                   │
│  │      └─ competitors[], competitorBriefing             │                   │
│  │      └─ 경쟁 차별화 포인트 주입                       │                   │
│  │                                                       │                   │
│  │  [+] Channel Adaptation Component                     │                   │
│  │      └─ 채널별 최적화 (X, Instagram, LinkedIn...)     │                   │
│  │                                                       │                   │
│  └───────────────────────────────────────────────────────┘                   │
│                          │                                                   │
│                          ▼ 점수 81+ 달성 시 언락                             │
│  ┌─────────────── MASTER TIER (점수 81-100) ────────────┐                   │
│  │                                                       │                   │
│  │  [+] Real-Time Market Trends Component                │                   │
│  │      └─ NewsAPI 트렌드 키워드                         │                   │
│  │      └─ 실시간 업계 동향 반영                         │                   │
│  │                                                       │                   │
│  │  [+] Historical Performance Component                 │                   │
│  │      └─ 과거 성공 콘텐츠 분석                         │                   │
│  │      └─ 높은 engagement 패턴 학습                     │                   │
│  │                                                       │                   │
│  │  [+] Personalized Optimization Component              │                   │
│  │      └─ 사용자별 선호도 학습                          │                   │
│  │      └─ A/B 테스트 결과 반영                          │                   │
│  │                                                       │                   │
│  │  [+] Multi-Channel Orchestration Component            │                   │
│  │      └─ 크로스 채널 전략 조율                         │                   │
│  │      └─ 채널별 최적 시간대 반영                       │                   │
│  │                                                       │                   │
│  └───────────────────────────────────────────────────────┘                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 인터랙티브 가이드 시스템

### 3.1 챗봇 기반 Progressive Onboarding

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    INTERACTIVE UPGRADE JOURNEY                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│    ┌──────────────────────────────────────────────────────────────────┐     │
│    │  🤖 ZYNK Bot: "현재 Brand Health Score가 30점이에요!            │     │
│    │      Knowledge Hub에 브랜드 자료를 추가하면 +20점을 얻고         │     │
│    │      더 정확한 콘텐츠를 만들 수 있어요. 지금 해볼까요?"          │     │
│    │                                                                   │     │
│    │      [📚 Knowledge Hub 열기]  [⏭️ 나중에]  [❓ 자세히]           │     │
│    └──────────────────────────────────────────────────────────────────┘     │
│                                                                              │
│    ▼ 사용자가 Knowledge Hub 추가 완료                                       │
│                                                                              │
│    ┌──────────────────────────────────────────────────────────────────┐     │
│    │  🤖 ZYNK Bot: "훌륭해요! 50점 달성! 🎉                          │     │
│    │      이제 [Competitor Intelligence] 기능이 언락되었어요!         │     │
│    │      경쟁사 분석을 추가하면 차별화된 콘텐츠를 만들 수 있어요.    │     │
│    │                                                                   │     │
│    │      [🔍 경쟁사 분석 시작]  [📝 Brand Voice 설정]               │     │
│    └──────────────────────────────────────────────────────────────────┘     │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 스코어 기반 기능 언락 UI

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      FEATURE UNLOCK DASHBOARD                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Current Score: 45/100  ████████░░░░░░░░░░░░░ 45%                          │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │ ✅ UNLOCKED FEATURES                                                 │   │
│   ├─────────────────────────────────────────────────────────────────────┤   │
│   │ ✓ Basic Content Generation                                          │   │
│   │ ✓ Brand Voice Injection (Tier 1)                                    │   │
│   │ ✓ Knowledge Base (3 docs)                                           │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │ 🔒 LOCKED FEATURES (51점에 언락)                                    │   │
│   ├─────────────────────────────────────────────────────────────────────┤   │
│   │ 🔒 Advanced Knowledge (10 docs)          [+5점 필요]                │   │
│   │ 🔒 Competitor Intelligence               [+5점 필요]                │   │
│   │ 🔒 Channel Optimization                  [+5점 필요]                │   │
│   │                                                                     │   │
│   │    💡 TIP: Brand Guidelines를 추가하면 +8점을 얻을 수 있어요!      │   │
│   │           [Brand Guidelines 추가하기 →]                             │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 점수 산정 기준 상세

### 4.1 Brand Health Score 구성

| 카테고리 | 배점 | 세부 항목 | 점수 |
|---------|------|----------|------|
| **Core Identity** | 30점 | 프로젝트 이름 | 10점 |
| | | 산업 분류 선택 | 5점 |
| | | 상세 설명 (100자+) | 10점 |
| | | 타겟 오디언스 정의 | 5점 |
| **Knowledge Base** | 25점 | 문서 1개 추가 | 5점 |
| | | 문서 3개 이상 | 10점 |
| | | 문서 5개 이상 | 5점 |
| | | AI 요약 생성됨 | 5점 |
| **Strategy** | 25점 | Brand Persona 설정 | 8점 |
| | | Tone 슬라이더 조정 | 5점 |
| | | Do's/Don'ts 각 3개+ | 7점 |
| | | 키워드 5개+ 설정 | 5점 |
| **Update Frequency** | 10점 | 7일 내 업데이트 | 10점 |
| | | 30일 내 업데이트 | 5점 |
| | | 30일 초과 | 0점 |
| **Quality Metrics** | 10점 | 콘텐츠 생성 10회+ | 5점 |
| | | 콘텐츠 승인율 70%+ | 5점 |

### 4.2 Knowledge Score 구성

| 카테고리 | 배점 | 조건 |
|---------|------|------|
| **문서 수** | 30점 | 0개: 0점, 1개: 10점, 3개: 20점, 5개+: 30점 |
| **문서 품질** | 25점 | 평균 길이 기반 (500자 미만: 5점, 1000자+: 15점, 3000자+: 25점) |
| **다양성** | 20점 | 1종류: 5점, 2종류: 12점, 3종류+: 20점 |
| **최신성** | 15점 | 최신 문서 7일 내: 15점, 30일 내: 8점, 이외: 3점 |
| **AI 활용** | 10점 | AI 요약 비율 50%+: 5점, 80%+: 10점 |

---

## 5. 구현 로드맵

### Phase 1: 점수 시스템 기초 (2주)
- [ ] `calculateBrandHealthScore()` 함수 구현
- [ ] `calculateKnowledgeScore()` 함수 구현
- [ ] Firestore에 점수 캐싱 (users/{uid}/metrics)
- [ ] Brand Brain UI에 점수 표시

### Phase 2: 컴포넌트 모듈화 (2주)
- [ ] Context Component 인터페이스 정의
- [ ] Tier별 컴포넌트 클래스 구현
- [ ] `executeSubAgent`에 컴포넌트 조립 로직 추가
- [ ] 점수 기반 컴포넌트 언락 로직

### Phase 3: 인터랙티브 가이드 (2주)
- [ ] ZYNK Bot에 점수 기반 추천 로직 추가
- [ ] 업그레이드 팁 알림 시스템
- [ ] Feature Unlock Dashboard UI
- [ ] 진행률 표시 및 마일스톤

### Phase 4: 고급 기능 (2주)
- [ ] Historical Performance Component 구현
- [ ] 채널별 성과 데이터 수집
- [ ] A/B 테스트 프레임워크
- [ ] 개인화 추천 엔진

---

## 6. 기대 효과

| 지표 | 현재 | 목표 |
|------|------|------|
| 신규 사용자 이탈률 | 높음 | 50% 감소 |
| 평균 Knowledge Hub 문서 수 | 1.2개 | 4개+ |
| Brand Brain 완성률 | 30% | 70% |
| 콘텐츠 승인률 | 60% | 85% |
| 재방문율 | 낮음 | 2x 증가 |

---

*문서 작성일: 2026-01-17*
*버전: 1.0*
