<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZYNK - Studio</title>
    <meta name="description" content="ZYNK Studio - AI Content Creation Dashboard">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="studio.css">

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="report-visualizer.js"></script>

    <meta name="theme-color" content="#0A0A0F">
</head>

<body class="studio-body">
    <!-- Studio Header -->
    <header class="studio-header">
        <div class="studio-header-left">
            <a href="../command-center.html" class="studio-back-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"></path>
                </svg>
            </a>
            <!-- Dynamic Studio Header -->
            <div id="studio-header-container"></div>
        </div>

        <div class="studio-header-center">
            <!-- Project & Agent Team Selector -->
            <div class="studio-selector-group">
                <div class="studio-selector">
                    <label>Project</label>
                    <select id="project-select">
                        <option value="">Select Project...</option>
                    </select>
                </div>
                <!-- Agent Team selector removed: Auto-loaded from project -->
            </div>
        </div>

        <div class="studio-header-right">
            <button id="booster-toggle-btn" class="booster-btn" title="Activate Booster Mode (Max Performance)">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z">
                    </path>
                    <path
                        d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z">
                    </path>
                    <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"></path>
                    <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"></path>
                </svg>
                <span>BOOST</span>
            </button>
            <div class="studio-timer" id="studio-timer">
                <span class="timer-dot"></span>
                <span>00:00</span>
            </div>
            <button class="studio-close-btn" onclick="window.location.href='../command-center.html'">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
    </header>

    <!-- Main 3-Panel Layout -->
    <main class="studio-main">
        <!-- LEFT PANEL: Workflow Config -->
        <aside class="studio-panel studio-panel-left">
            <div class="panel-section header-section">
                <div class="panel-header-row">
                    <h3 class="panel-title">Workflow Config</h3>
                    <button id="sidebar-toggle" class="sidebar-toggle-btn" aria-label="Toggle Sidebar">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <path d="M15 10l-2 2 2 2"></path>
                        </svg>
                    </button>
                </div>

                <div class="config-group">
                    <label>Template Selection</label>
                    <select id="workflow-template" class="template-dropdown">
                        <option value="quick">Quick Post</option>
                        <option value="standard" selected>Standard</option>
                        <option value="premium">Premium</option>
                        <option value="seo_focused">SEO Focused</option>
                        <option value="full_media">Full Media</option>
                    </select>
                </div>
            </div>

            <div class="panel-section flex-grow">
                <div class="panel-header-row"
                    style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 class="panel-title">Agent Roster <span class="agent-count">(12)</span></h3>
                    <button id="btn-team-settings" class="team-settings-btn" onclick="openTeamSettingsModal()"
                        title="Team Settings">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div id="agent-roster" class="agent-roster-grid">
                    <!-- Phase 1: Research -->
                    <div class="agent-card active" data-agent="research">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-research" />
                        </svg>
                        <div class="agent-label">Research</div>
                    </div>
                    <div class="agent-card" data-agent="seo_watcher">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-seo_watcher" />
                        </svg>
                        <div class="agent-label">SEO Watcher</div>
                    </div>
                    <div class="agent-card active" data-agent="knowledge_curator">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-knowledge_curator" />
                        </svg>
                        <div class="agent-label">Knowledge</div>
                    </div>
                    <div class="agent-card" data-agent="kpi">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-kpi" />
                        </svg>
                        <div class="agent-label">KPI Advisor</div>
                    </div>

                    <!-- Required: Planner -->
                    <div class="agent-card active required" data-agent="planner">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-planner" />
                        </svg>
                        <div class="agent-label">Planner</div>
                    </div>

                    <!-- Phase 2: Creation -->
                    <div class="agent-card active required" data-agent="creator_text">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-creator_text" />
                        </svg>
                        <div class="agent-label">Text Creator</div>
                    </div>
                    <div class="agent-card" data-agent="creator_image">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-creator_image" />
                        </svg>
                        <div class="agent-label">Image Creator</div>
                    </div>
                    <div class="agent-card disabled" data-agent="creator_video">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-creator_video" />
                        </svg>
                        <div class="agent-label">Video Planner</div>
                    </div>

                    <!-- Phase 3: Validation -->
                    <div class="agent-card active" data-agent="compliance">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-compliance" />
                        </svg>
                        <div class="agent-label">Compliance</div>
                    </div>
                    <div class="agent-card" data-agent="seo_optimizer">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-seo_optimizer" />
                        </svg>
                        <div class="agent-label">SEO Optimizer</div>
                    </div>
                    <div class="agent-card" data-agent="evaluator">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-evaluator" />
                        </svg>
                        <div class="agent-label">Evaluator</div>
                    </div>

                    <!-- Phase 4: Final -->
                    <div class="agent-card active required" data-agent="manager">
                        <svg class="agent-icon">
                            <use href="agent-icons.svg#icon-manager" />
                        </svg>
                        <div class="agent-label">Manager</div>
                    </div>
                </div>
            </div>

            <div class="panel-section stats-section">
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">Selected:</div>
                        <div class="stat-value" id="stats-agents">10/12 agents</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Est. Time:</div>
                        <div class="stat-value" id="stats-time">3 min</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Cost:</div>
                        <div class="stat-value" id="stats-cost">$0.15</div>
                    </div>
                </div>
            </div>

            <button id="start-execution-btn" class="btn-start-execution" disabled>
                Start Execution ‚ñ∂
            </button>
        </aside>

        <!-- CENTER PANEL: Pipeline Visualization -->
        <section class="studio-panel studio-panel-center">
            <div class="panel-section dag-section">
                <div class="dag-header">
                    <h3 class="panel-title">Workflow Pipeline</h3>
                    <div class="dag-zoom-controls">
                        <button class="zoom-btn" id="zoom-out" title="Zoom Out">‚àí</button>
                        <span class="zoom-level" id="zoom-level">100%</span>
                        <button class="zoom-btn" id="zoom-in" title="Zoom In">+</button>
                        <button class="zoom-btn" id="zoom-reset" title="Reset">‚ü≤</button>
                    </div>
                </div>
                <div id="dag-visualizer" class="dag-visualizer">
                    <div id="dag-canvas" class="dag-canvas">
                        <svg id="dag-svg" class="dag-svg" viewBox="0 0 500 480">
                            <defs>
                                <!-- Gradient for connections -->
                                <linearGradient id="connection-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stop-color="#8B5CF6" stop-opacity="0.6" />
                                    <stop offset="100%" stop-color="#16E0BD" stop-opacity="0.8" />
                                </linearGradient>
                                <!-- Glow filter for active nodes -->
                                <filter id="glow-running" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur stdDeviation="3" result="blur" />
                                    <feMerge>
                                        <feMergeNode in="blur" />
                                        <feMergeNode in="SourceGraphic" />
                                    </feMerge>
                                </filter>
                                <filter id="glow-complete" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur stdDeviation="3" result="blur" />
                                    <feMerge>
                                        <feMergeNode in="blur" />
                                        <feMergeNode in="SourceGraphic" />
                                    </feMerge>
                                </filter>
                                <!-- Particle gradient -->
                                <radialGradient id="particle-gradient">
                                    <stop offset="0%" stop-color="#16E0BD" />
                                    <stop offset="100%" stop-color="#16E0BD" stop-opacity="0" />
                                </radialGradient>
                            </defs>

                            <!-- Connection Paths Group -->
                            <g id="dag-connections" class="dag-connections">
                                <!-- Phase 1 (Research Row) to Planner -->
                                <!-- Research (100,100) to Planner (260,130) -->
                                <path class="dag-path" id="path-research-planner"
                                    d="M100,100 C100,115 260,115 260,130" />
                                <!-- SEO (200,100) to Planner (260,130) -->
                                <path class="dag-path" id="path-seo-planner" d="M200,100 C200,115 260,115 260,130" />
                                <!-- Knowledge (300,100) to Planner (260,130) -->
                                <path class="dag-path" id="path-knowledge-planner"
                                    d="M300,100 C300,115 260,115 260,130" />
                                <!-- KPI (400,100) to Planner (260,130) -->
                                <path class="dag-path" id="path-kpi-planner" d="M400,100 C400,115 260,115 260,130" />

                                <!-- Planner (260,190) to Creation -->
                                <!-- Planner to Text (150,220) -->
                                <path class="dag-path" id="path-planner-text" d="M260,190 C260,205 150,205 150,220" />
                                <!-- Planner to Image (280,220) -->
                                <path class="dag-path" id="path-planner-image" d="M260,190 C260,205 280,205 280,220" />
                                <!-- Planner to Video (400,220) -->
                                <path class="dag-path" id="path-planner-video" d="M260,190 C260,205 400,205 400,220" />

                                <!-- Creation to Validation -->
                                <!-- Text (150,280) to Compliance (100,310) -->
                                <path class="dag-path" id="path-text-compliance"
                                    d="M150,280 C150,295 100,295 100,310" />
                                <!-- Text (150,280) to SEO Opt (220,310) -->
                                <path class="dag-path" id="path-text-seo" d="M150,280 C150,295 220,295 220,310" />
                                <!-- Image (280,280) to Evaluator (340,310) -->
                                <path class="dag-path" id="path-image-evaluator"
                                    d="M280,280 C280,295 340,295 340,310" />

                                <!-- Validation to Manager (260,400) -->
                                <!-- Compliance (100,370) to Manager -->
                                <path class="dag-path" id="path-compliance-manager"
                                    d="M100,370 C100,385 260,385 260,400" />
                                <!-- SEO Opt (220,370) to Manager -->
                                <path class="dag-path" id="path-seo-manager" d="M220,370 C220,385 260,385 260,400" />
                                <!-- Evaluator (340,370) to Manager -->
                                <path class="dag-path" id="path-evaluator-manager"
                                    d="M340,370 C340,385 260,385 260,400" />
                            </g>

                            <!-- Particle Effects Group -->
                            <g id="dag-particles" class="dag-particles">
                                <!-- Particles will be dynamically added here -->
                            </g>

                            <!-- Nodes Group -->
                            <g id="dag-nodes" class="dag-nodes">
                                <!-- Phase 1: Research -->
                                <g class="dag-node waiting" id="node-research" transform="translate(60, 40)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="11" cy="11" r="8" />
                                        <path d="M21 21l-4.35-4.35" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Research</text>
                                </g>
                                <g class="dag-node waiting" id="node-seo" transform="translate(160, 40)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="12" cy="12" r="10" />
                                        <path d="M12 6v6l4 2" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">SEO</text>
                                </g>
                                <g class="dag-node waiting" id="node-knowledge" transform="translate(260, 40)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M4 19.5A2.5 2.5 0 016.5 17H20" />
                                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Knowledge</text>
                                </g>
                                <g class="dag-node waiting" id="node-kpi" transform="translate(360, 40)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">KPI</text>
                                </g>

                                <!-- Aggregator: Planner -->
                                <g class="dag-node waiting" id="node-planner" transform="translate(220, 130)">
                                    <rect class="node-bg node-main" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="12" cy="12" r="10" />
                                        <circle cx="12" cy="12" r="6" />
                                        <circle cx="12" cy="12" r="2" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Planner</text>
                                </g>

                                <!-- Phase 2: Creation -->
                                <g class="dag-node waiting" id="node-text" transform="translate(110, 220)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M12 19l7-7 3 3-7 7-3-3z" />
                                        <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Text</text>
                                </g>
                                <g class="dag-node waiting" id="node-image" transform="translate(240, 220)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="3" y="3" width="18" height="18" rx="2" />
                                        <circle cx="8.5" cy="8.5" r="1.5" />
                                        <path d="M21 15l-5-5L5 21" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Image</text>
                                </g>
                                <g class="dag-node waiting disabled" id="node-video" transform="translate(360, 220)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="2" y="4" width="20" height="14" rx="2" />
                                        <path d="M10 9l5 3-5 3z" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Video</text>
                                </g>

                                <!-- Phase 3: Validation -->
                                <g class="dag-node waiting" id="node-compliance" transform="translate(60, 310)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Compliance</text>
                                </g>
                                <g class="dag-node waiting" id="node-seo-opt" transform="translate(180, 310)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="12" cy="12" r="3" />
                                        <path
                                            d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">SEO Opt</text>
                                </g>
                                <g class="dag-node waiting" id="node-evaluator" transform="translate(300, 310)">
                                    <rect class="node-bg" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" />
                                        <path d="M9 15l2 2 4-4" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Evaluator</text>
                                </g>

                                <!-- Phase 4: Final -->
                                <g class="dag-node waiting" id="node-manager" transform="translate(220, 400)">
                                    <rect class="node-bg node-main" x="0" y="0" width="80" height="60" rx="8" />
                                    <svg class="node-icon" x="28" y="8" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
                                        <circle cx="12" cy="7" r="4" />
                                    </svg>
                                    <text class="node-label" x="40" y="48" text-anchor="middle">Manager</text>
                                </g>
                            </g>

                            <!-- Phase Labels -->
                            <g class="dag-phase-labels">
                                <text class="phase-label" x="20" y="70" transform="rotate(-90, 20, 70)">Research</text>
                                <text class="phase-label" x="20" y="160"
                                    transform="rotate(-90, 20, 160)">Planning</text>
                                <text class="phase-label" x="20" y="250"
                                    transform="rotate(-90, 20, 250)">Creation</text>
                                <text class="phase-label" x="20" y="340"
                                    transform="rotate(-90, 20, 340)">Validation</text>
                                <text class="phase-label" x="20" y="430" transform="rotate(-90, 20, 430)">Final</text>
                            </g>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <h3 class="panel-title">Activity Log</h3>
                <div id="activity-log" class="activity-log">
                    <div class="log-entry">
                        <span class="log-time">[--:--:--]</span>
                        <span class="log-message">Waiting for execution to start...</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- RIGHT PANEL: Live Preview -->
        <aside class="studio-panel studio-panel-right">
            <div class="panel-section">
                <h3 class="panel-title">Live Preview</h3>

                <!-- Status Indicator -->
                <div class="approval-status" style="margin-top: 12px; margin-bottom: 4px;">
                    <div class="status-badges">
                        <span class="status-badge active" id="status-pending">PENDING</span>
                        <span class="status-badge" id="status-discarded">DISCARDED</span>
                        <span class="status-badge" id="status-approved">APPROVED</span>
                    </div>
                </div>
            </div>

            <div class="panel-section preview-content" id="multi-channel-preview-container">
                <!-- Channel Tabs -->
                <div class="channel-preview-tabs" id="channel-preview-tabs">
                    <!-- Tabs will be dynamically rendered here -->
                    <div class="tab-placeholder">Select channels to preview</div>
                </div>
                <!-- View All Button -->
                <button class="view-all-btn" id="view-all-channels-btn" title="View All Channels" style="display:none;"
                    onclick="openMultiChannelOverview()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                </button>
                <!-- Single Channel Preview Area -->
                <div class="single-channel-preview" id="single-channel-preview">
                    <div class="preview-placeholder">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1" opacity="0.3">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        <p>Start execution to see content preview</p>
                    </div>
                </div>
            </div>

            <!-- Content Approval Controls -->
            <div class="panel-section approval-section">
                <!-- Status Indicator moved to top -->

                <!-- AI Feedback Prompt -->
                <div class="feedback-prompt">
                    <textarea id="feedback-input" class="feedback-input"
                        placeholder="Add feedback for AI regeneration (e.g., 'Make it more professional', 'Add more emojis')..."></textarea>
                </div>

                <!-- Action Buttons -->
                <div class="approval-actions">
                    <button class="approval-btn btn-edit" id="btn-edit" onclick="toggleEditMode()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        <span id="btn-edit-text">Edit</span>
                    </button>
                    <button class="approval-btn btn-discard" id="btn-discard" onclick="discardContent()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        Discard
                    </button>
                    <button class="approval-btn btn-regenerate" id="btn-regenerate" onclick="regenerateContent()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                        Redo
                    </button>
                    <button class="approval-btn btn-approve" id="btn-approve" onclick="approveContent()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        Approve
                    </button>
                </div>
            </div>

            <div class="panel-section">
                <div class="section-header-row" style="display:flex; align-items:center; gap:8px; margin-bottom:15px;">
                    <h3 class="panel-title" style="margin-bottom:0;">Agent Insights</h3>
                    <div class="info-icon-wrapper" style="position:relative;">
                        <svg class="info-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" style="cursor:pointer; opacity:0.6;">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        <div class="tooltip-bubble" id="insights-tooltip">
                            <!-- Korean Version (for future usage)
                            <h4 style="margin:0 0 8px 0; color:#fff; font-size:14px;">Agent Insights ÎûÄ?</h4>
                            <p style="margin:0 0 8px 0; font-size:13px; color:#ccc; line-height:1.4;">AI ÏóêÏù¥Ï†ÑÌä∏Í∞Ä ÏÉùÏÑ±Îêú ÏΩòÌÖêÏ∏†Î•º Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î∂ÑÏÑùÌïú Í≤∞Í≥ºÏßÄÌëúÏûÖÎãàÎã§.</p>
                            <ul style="margin:0; padding-left:16px; font-size:12px; color:#aaa; line-height:1.5;">
                                <li><strong>SEO Score:</strong> Í≤ÄÏÉâ ÎÖ∏Ï∂ú ÏµúÏ†ÅÌôî Ï†êÏàò (ÌÇ§ÏõåÎìú Î∞ÄÎèÑ, Í∞ÄÎèÖÏÑ± Îì± Î∂ÑÏÑù)</li>
                                <li><strong>Compliance:</strong> Î∏åÎûúÎìú Í∞ÄÏù¥ÎìúÎùºÏù∏, Ï†ÄÏûëÍ∂å, ÌîåÎû´Ìèº Ï†ïÏ±Ö Ï§ÄÏàò Ïó¨Î∂Ä</li>
                            </ul>
                            <div style="margin-top:10px; padding-top:8px; border-top:1px solid #444;">
                                <p style="margin:0 0 5px 0; font-size:12px; font-weight:bold; color:#fff;">Ï†êÏàò Í∏∞Ï§Ä:</p>
                                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:4px; font-size:11px;">
                                    <span style="color:#10b981;">‚óè 90+: Excellent</span>
                                    <span style="color:#34d399;">‚óè 70-89: Good</span>
                                    <span style="color:#fbbf24;">‚óè 50-69: Fair</span>
                                    <span style="color:#ef4444;">‚óè &lt; 50: Needs Work</span>
                                </div>
                            </div>
                            -->
                            <h4 style="margin:0 0 8px 0; color:#fff; font-size:14px;">What is Agent Insights?</h4>
                            <p style="margin:0 0 8px 0; font-size:13px; color:#ccc; line-height:1.4;">Real-time quality
                                metrics for AI-generated content.</p>
                            <ul style="margin:0; padding-left:16px; font-size:12px; color:#aaa; line-height:1.5;">
                                <li><strong>SEO Score:</strong> Search optimization score (keyword density,
                                    readability).</li>
                                <li><strong>Compliance:</strong> Adherence to brand guidelines, copyright, and platform
                                    policies.</li>
                            </ul>
                            <div style="margin-top:10px; padding-top:8px; border-top:1px solid #444;">
                                <p style="margin:0 0 5px 0; font-size:12px; font-weight:bold; color:#fff;">Score Levels:
                                </p>
                                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:4px; font-size:11px;">
                                    <span style="color:#10b981;">‚óè 90+: Excellent</span>
                                    <span style="color:#34d399;">‚óè 70-89: Good</span>
                                    <span style="color:#fbbf24;">‚óè 50-69: Fair</span>
                                    <span style="color:#ef4444;">‚óè &lt; 50: Needs Work</span>
                                </div>
                            </div>
                            <div class="tooltip-arrow"></div>
                        </div>
                    </div>
                </div>
                <div class="insights-card">
                    <div class="insights-circles">
                        <!-- SEO Score Circle -->
                        <div class="insight-circle-wrap">
                            <div class="insight-circle" id="seo-circle">
                                <svg viewBox="0 0 100 100">
                                    <circle class="circle-bg" cx="50" cy="50" r="42" />
                                    <circle class="circle-progress seo-progress" cx="50" cy="50" r="42"
                                        stroke-dasharray="264" stroke-dashoffset="264" id="seo-progress-ring" />
                                </svg>
                                <div class="circle-value">
                                    <span class="value-number" id="seo-value">--</span>
                                    <span class="value-unit">%</span>
                                </div>
                            </div>
                            <div class="insight-label">SEO Score</div>
                            <div class="insight-sublabel" id="seo-sublabel">--/100 - Waiting</div>
                        </div>

                        <!-- Compliance Circle -->
                        <div class="insight-circle-wrap">
                            <div class="insight-circle" id="compliance-circle">
                                <svg viewBox="0 0 100 100">
                                    <circle class="circle-bg" cx="50" cy="50" r="42" />
                                    <circle class="circle-progress compliance-progress" cx="50" cy="50" r="42"
                                        stroke-dasharray="264" stroke-dashoffset="264" id="compliance-progress-ring" />
                                </svg>
                                <div class="circle-value">
                                    <span class="value-number" id="compliance-value">--</span>
                                    <span class="value-unit">%</span>
                                </div>
                                <div class="compliance-check" id="compliance-check" style="display:none;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                        <polyline points="20 6 9 17 4 12" />
                                    </svg>
                                </div>
                            </div>
                            <div class="insight-label">Compliance</div>
                            <div class="insight-sublabel" id="compliance-sublabel">Status: Waiting</div>
                        </div>
                    </div>
                    <div class="insights-footer">
                        Insights updated every 30s.
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- Footer Controls -->
    <footer class="studio-footer">
        <div class="footer-left">
            <button id="pause-btn" class="footer-btn" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="6" y="4" width="4" height="16"></rect>
                    <rect x="14" y="4" width="4" height="16"></rect>
                </svg>
                Pause
            </button>
            <button id="stop-btn" class="footer-btn btn-danger" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                </svg>
                Stop
            </button>
        </div>
        <div class="footer-center">
            <span id="footer-progress">Phase --/-- ‚Ä¢ Agent --/--</span>
        </div>
        <div class="footer-right">
            <button id="retry-btn" class="footer-btn" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 4 23 10 17 10"></polyline>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                </svg>
                Retry
            </button>
            <button id="complete-btn" class="footer-btn btn-success" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                Complete
            </button>
        </div>
    </footer>

    <!-- Agent Report Modal -->
    <div id="agent-report-modal" class="modal-backdrop" style="display: none;">
        <div class="modal-content report-modal">
            <div class="modal-header">
                <h3 class="modal-title flex items-center gap-2">
                    <span id="report-agent-icon">ü§ñ</span>
                    <span id="report-agent-name">Agent Report</span>
                </h3>
                <button class="modal-close-btn" onclick="closeAgentReport()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="report-stats-bar">
                    <div class="stat-item">
                        <span class="label">Model:</span>
                        <span class="value" id="report-model">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">Tokens:</span>
                        <span class="value" id="report-tokens">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">Resources:</span>
                        <span class="value" id="report-resource-count">0</span>
                    </div>
                </div>

                <!-- D3 Visualization Container -->
                <div id="report-vis-container" class="report-vis-container">
                    <!-- Graph will be rendered here -->
                </div>

                <!-- Reference Details -->
                <div class="report-details">
                    <h4 class="details-title">Reference Details</h4>
                    <ul id="report-details-list" class="details-list">
                        <!-- List items -->
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="closeAgentReport()">Close Report</button>
            </div>
        </div>
    </div>

    <!-- Team Settings Modal -->
    <div id="team-settings-modal" class="modal-backdrop" style="display: none;">
        <div class="modal-content team-settings-modal">
            <div class="modal-header">
                <h3 class="modal-title flex items-center gap-2">
                    <span>üß†</span>
                    <span>Team Brain Settings</span>
                </h3>
                <button class="modal-close-btn" onclick="closeTeamSettingsModal()">√ó</button>
            </div>
            <div class="modal-body" style="overflow-y: auto; max-height: 60vh; padding: 20px;">
                <!-- Team Info Section -->
                <div class="team-settings-section">
                    <div class="section-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Team Information
                    </div>
                    <div class="team-info-card">
                        <div class="team-name" id="settings-team-name">Loading...</div>
                        <div class="team-channel" id="settings-team-channel"></div>
                    </div>
                </div>

                <!-- Team Goal Section -->
                <div class="team-settings-section">
                    <div class="section-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <circle cx="12" cy="12" r="6"></circle>
                            <circle cx="12" cy="12" r="2"></circle>
                        </svg>
                        Team Goal (Active Directive)
                    </div>
                    <div class="team-goal-card" id="settings-team-goal">
                        <p class="placeholder-text">No team goal defined yet.</p>
                    </div>
                </div>

                <!-- Sub-Agents Configuration Section -->
                <div class="team-settings-section">
                    <div class="section-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="9" y1="21" x2="9" y2="9"></line>
                        </svg>
                        Sub-Agent Configurations
                    </div>
                    <div id="settings-subagents-list" class="subagents-config-list">
                        <div class="loading-placeholder">Loading agent configurations...</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeTeamSettingsModal()">Close</button>
                <button class="btn-primary" onclick="applyTeamSettings()">Apply to Agents</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-functions-compat.js"></script>

    <!-- Config & Auth -->
    <script src="../firebase-config.js"></script>
    <script src="../env-config.js"></script>
    <script src="../auth.js"></script>

    <!-- Studio Scripts -->
    <script src="../utils-channel-profiles.js"></script>
    <script src="dag-executor.js"></script>
    <script src="studio.js?v=tabbed_preview_v1"></script>

    <!-- ZYNK AI Chatbot -->
    <link rel="stylesheet" href="../chatbot.css">
    <button id="chatbot-fab" class="chatbot-fab" aria-label="Open ZYNK Assistant">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
    </button>
    <div id="chatbot-panel" class="chatbot-panel">
        <div class="chatbot-header">
            <div class="chatbot-header-icon">ü§ñ</div>
            <div class="chatbot-header-info">
                <p class="chatbot-header-title">ZYNK Assistant</p>
                <small class="chatbot-header-subtitle">AI Ìó¨ÌîÑÎç∞Ïä§ÌÅ¨</small>
            </div>
            <span id="chatbot-usage" class="chatbot-usage-badge">0/50</span>
            <button id="chatbot-close" class="chatbot-close-btn" aria-label="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M18 6 6 18"></path>
                    <path d="m6 6 12 12"></path>
                </svg>
            </button>
        </div>
        <div id="chatbot-messages" class="chatbot-messages"></div>
        <div class="chatbot-input-area">
            <input type="text" id="chatbot-input" class="chatbot-input" placeholder="ZYNKÏóê ÎåÄÌï¥ Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî..." />
            <button id="chatbot-send" class="chatbot-send-btn" aria-label="Send">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="m22 2-7 20-4-9-9-4Z"></path>
                    <path d="M22 2 11 13"></path>
                </svg>
            </button>
        </div>
    </div>
    <script src="../chatbot-v2.js"></script>

    <!-- UI Loader -->
    <script src="../utils-ui-config.js"></script>
    <script src="../utils-ui-loader.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof UI !== 'undefined') {
                UI.renderHeader('studio-header-container', 'studio');
            }
        });
    </script>
</body>

</html>