<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZYNK - Command Center</title>
    <meta name="description" content="ZYNK Command Center">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="chatbot.css">

    <!-- PWA (Disabled for now) -->
    <!-- <link rel="manifest" href="manifest.json"> -->
    <!-- PWA Disabled: Theme color kept for browser UI -->
    <meta name="theme-color" content="#0A0A0F">
</head>

<body class="dashboard-body">
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="logo">
                    <svg class="logo-icon" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 0L40 10V30L20 40L0 30V10L20 0Z" fill="url(#logo-gradient)" />
                        <text x="20" y="29" font-size="22" font-weight="800" fill="white" text-anchor="middle"
                            font-family="Inter, sans-serif">Z</text>
                        <defs>
                            <linearGradient id="logo-gradient" x1="0" y1="0" x2="40" y2="40">
                                <stop offset="0%" stop-color="#8B5CF6" />
                                <stop offset="100%" stop-color="#3B82F6" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <span class="logo-text">ZYNK</span>
                </a>
            </div>

            <!-- Sidebar Content Dynamic Loader -->
            <div id="sidebar-menu-area" class="sidebar-menu">
                <!-- Loaded via utils-ui-loader.js -->
            </div>

        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Header -->
            <header class="dashboard-header">
                <div>
                    <!-- Mobile Menu Toggle -->
                    <div class="hamburger dashboard-toggle" id="mobile-menu-toggle">
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </div>
                    <h1 data-i18n="dashboard.title">Command Center</h1>
                    <div class="header-subtitle" data-i18n="dashboard.subtitle">High-level oversight of all managed
                        client hives.</div>
                </div>
                <div class="header-controls">
                    <span id="credit-display" class="credit-badge"
                        style="font-size: 12px; padding: 6px 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-right: 12px;">
                        ü™ô <span id="credit-count">--</span> credits
                    </span>
                    <button id="btn-lang-en" class="btn-lang-sm active"
                        style="background: var(--color-cyan); color: #000; font-weight: bold;">EN</button>
                    <button id="btn-lang-ko" class="btn-lang-sm">KR</button>
                    <div id="user-profile-container"></div>
                </div>
            </header>

            <div class="dashboard-content">
                <!-- üîπ ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú ÎûòÌçº -->
                <div class="dashboard-inner">

                    <!-- Section 1: Client Hive Overview -->
                    <section class="dashboard-section">
                        <div class="section-header">
                            <h2 data-i18n="dashboard.section1">1. Client Hive Overview</h2>
                            <svg class="info-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                        </div>

                        <div class="hive-grid" id="hive-grid">
                            <!-- Dynamic Content Loaded via command-center.js -->
                        </div>
                    </section>


                </div> <!-- üîπ dashboard-inner ÎÅù -->
            </div>
        </main>
    </div>



    <!-- Initialize Your Hive Modal (Wizard) -->
    <div id="create-project-modal" class="modal-overlay">
        <div class="modal-content wizard-modal">
            <div class="modal-header">
                <h3>Initialize Your Hive</h3>
                <button id="close-modal-btn" class="close-btn">&times;</button>
            </div>

            <!-- Wizard Progress -->
            <div class="wizard-progress">
                <div class="step-indicator active" data-step="1">
                    <div class="step-number">1</div>
                    <span class="step-label">Basic Info</span>
                </div>
                <div class="step-line"></div>
                <div class="step-indicator" data-step="2">
                    <div class="step-number">2</div>
                    <span class="step-label">Details</span>
                </div>
                <div class="step-line"></div>
                <div class="step-indicator" data-step="3">
                    <div class="step-number">3</div>
                    <span class="step-label">Launch</span>
                </div>
            </div>

            <form id="create-project-form">
                <!-- Step 1: Project Brief (PRD 11.0) -->
                <div class="wizard-step active" id="step-1">
                    <h4 style="margin-bottom: 20px; color: var(--color-cyan);">Project Brief</h4>
                    <p style="font-size: 13px; color: rgba(255,255,255,0.6); margin-bottom: 24px;">
                        Provide essential information about your business to help AI agents understand your brand.
                    </p>

                    <div class="form-group">
                        <label for="business-name">Business / Brand Name *</label>
                        <input type="text" id="business-name" placeholder="e.g. Alpha Protocol" required>
                    </div>



                    <div class="form-row">
                        <div class="form-group half">
                            <label for="industry">Industry *</label>
                            <select id="industry" required>
                                <option value="" disabled selected>Loading industries...</option>
                            </select>
                        </div>
                        <div class="form-group half" id="custom-industry-container" style="display: none;">
                            <label for="industry-custom">Custom Industry</label>
                            <input type="text" id="industry-custom" placeholder="e.g. Legal Services">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="main-product">Main Product / Service *</label>
                        <input type="text" id="main-product" required
                            placeholder="e.g. AI-powered marketing automation platform">
                    </div>

                    <div class="form-group">
                        <label for="website-url">Website URL</label>
                        <input type="url" id="website-url" placeholder="https://example.com">
                    </div>

                    <div class="form-group">
                        <label for="target-markets">Target Markets *</label>
                        <input type="text" id="target-markets" required
                            placeholder="e.g. KR, US, SEA (comma-separated)">
                        <small style="color: rgba(255,255,255,0.5); font-size: 12px;">
                            Enter market codes separated by commas (e.g., KR, US, EU, SEA, Global)
                        </small>
                    </div>

                    <div class="form-row">
                        <div class="form-group half">
                            <label for="primary-objective">Primary Objective *</label>
                            <select id="primary-objective" required>
                                <option value="" disabled selected>Select objective...</option>
                                <option value="brand_awareness">Brand Awareness</option>
                                <option value="sales">Sales & Revenue</option>
                                <option value="leads">Lead Generation</option>
                                <option value="community">Community Building</option>
                                <option value="engagement">Engagement</option>
                                <option value="education">Education & Thought Leadership</option>
                            </select>
                        </div>
                        <div class="form-group half">
                            <label for="preferred-tone">Preferred Tone *</label>
                            <select id="preferred-tone" required>
                                <option value="" disabled selected>Select tone...</option>
                                <option value="friendly">Friendly & Casual</option>
                                <option value="professional">Professional</option>
                                <option value="witty">Witty & Humorous</option>
                                <option value="bold">Bold & Confident</option>
                                <option value="calm">Calm & Thoughtful</option>
                                <option value="inspirational">Inspirational</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="main-languages">Main Languages *</label>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px;">
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="ko" class="language-checkbox">
                                <span>Korean (KO)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="en" class="language-checkbox" checked>
                                <span>English (EN)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="ja" class="language-checkbox">
                                <span>Japanese (JA)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="zh" class="language-checkbox">
                                <span>Chinese (ZH)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="es" class="language-checkbox">
                                <span>Spanish (ES)</span>
                            </label>
                        </div>
                        <small style="color: rgba(255,255,255,0.5); font-size: 12px; display: block; margin-top: 8px;">
                            Select at least one language
                        </small>
                    </div>
                </div>

                <!-- Step 2: Details & Assets -->
                <div class="wizard-step" id="step-2">
                    <div class="form-group">
                        <label for="project-description">Project Description</label>
                        <textarea id="project-description" rows="4"
                            placeholder="Describe your project, key value propositions, and brand voice..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="asset-files">Brand Assets (Logo, Whitepaper, etc.)</label>
                        <div class="file-upload-area" id="file-drop-zone">
                            <input type="file" id="asset-files" multiple style="display: none;">
                            <div class="upload-icon">
                                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                            </div>
                            <p>Click to upload or drag and drop</p>
                            <div id="file-list" class="file-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Channels & Launch -->
                <div class="wizard-step" id="step-3">
                    <div style="margin-bottom: 24px;">
                        <h4 style="margin-bottom: 12px; color: var(--color-cyan);">Select Target Channels</h4>
                        <p style="font-size: 13px; color: rgba(255,255,255,0.6); margin-bottom: 16px;">
                            Where should your AI agents publish content? You can change this later.
                        </p>
                        <div id="wizard-channel-selector"></div>
                        <div id="channel-selection-error"
                            style="color:#ef4444; font-size:12px; margin-top:8px; display:none;">
                            Please select at least one channel.
                        </div>
                    </div>

                    <div class="summary-card" style="margin-top: 24px;">
                        <h4 style="font-size: 14px; margin-bottom: 12px;">Project Summary</h4>
                        <div class="summary-item">
                            <span class="label">Project:</span>
                            <span class="value" id="summary-name">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Industry:</span>
                            <span class="value" id="summary-industry">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Assets:</span>
                            <span class="value" id="summary-assets">0 files</span>
                        </div>
                    </div>
                    <p class="launch-note">
                        Initializing will deploy your Command Center dashboard and configure your AI agents.
                    </p>
                </div>

                <!-- Wizard Actions -->
                <div class="modal-actions wizard-actions">
                    <button type="button" id="prev-step-btn" class="btn-cancel" style="display: none;">Back</button>
                    <button type="button" id="next-step-btn" class="btn-submit">Next</button>
                    <button type="button" id="launch-btn" class="btn-submit btn-launch" style="display: none;">Launch
                        Command Center</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Resume Draft Modal -->
    <div id="resume-draft-modal" class="modal-overlay" style="z-index: 2000;">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h3 style="margin-bottom: 16px; color: var(--color-cyan);">Resume Unfinished Project?</h3>
            <p style="margin-bottom: 24px; color: rgba(255,255,255,0.8);">
                You have an unfinished project draft: <br>
                <strong id="draft-name-display" style="color: white; font-size: 1.1rem;">-</strong>
            </p>
            <div class="modal-actions" style="justify-content: center; gap: 16px;">
                <button id="btn-start-fresh" class="btn-secondary">Start Fresh</button>
                <button id="btn-resume-draft" class="btn-primary">Resume Draft</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs - MUST load before any Firebase-dependent scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-functions-compat.js"></script>

    <!-- Config & Auth -->
    <script src="firebase-config.js"></script>
    <script src="env-config.js"></script>
    <script src="auth.js"></script>

    <!-- Scripts -->
    <script src="translations.js"></script>
    <script src="utils-channel-selector.js"></script>
    <script src="scripts/sidebar-loader.js"></script>
    <script src="command-center.js?v=3"></script>

    <!-- Auth Check Script -->
    <script>
        // Simple auth check to redirect if not logged in
        // Note: auth.js also handles state changes, but this adds an immediate check
        firebase.auth().onAuthStateChanged(function (user) {
            if (!user) {
                window.location.href = 'index.html';
            } else {
                // Move profile to header
                const profileContainer = document.getElementById('user-profile-container');
                const navProfile = document.getElementById('user-profile');
                if (navProfile && profileContainer) {
                    profileContainer.appendChild(navProfile);
                }
            }
        });
    </script>

    <!-- ZYNK AI Helpdesk Chatbot -->
    <button id="chatbot-fab" class="chatbot-fab" aria-label="Open ZYNK Assistant">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
    </button>

    <div id="chatbot-panel" class="chatbot-panel">
        <div class="chatbot-header">
            <div class="chatbot-header-icon">ü§ñ</div>
            <div class="chatbot-header-info">
                <p class="chatbot-header-title">ZYNK Assistant</p>
                <p class="chatbot-header-subtitle">AI Ìó¨ÌîÑÎç∞Ïä§ÌÅ¨</p>
            </div>
            <span id="chatbot-usage" class="chatbot-usage-badge">0/50</span>
            <button id="chatbot-close" class="chatbot-close-btn" aria-label="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div id="chatbot-messages" class="chatbot-messages">
            <!-- Messages will be added here -->
        </div>
        <div class="chatbot-input-area">
            <input type="text" id="chatbot-input" class="chatbot-input" placeholder="ZYNKÏóê ÎåÄÌï¥ Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî..." />
            <button id="chatbot-send" class="chatbot-send-btn" aria-label="Send">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <script src="credits.js"></script>
    <script src="chatbot-v2.js"></script>

    <!-- UI Loader -->
    <script src="utils-ui-config.js"></script>
    <script src="utils-ui-loader.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof UI !== 'undefined') {
                UI.renderSidebar('sidebar-menu-area');
            }
        });
    </script>
</body>

</html>