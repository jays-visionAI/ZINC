<!-- Agent Registry Management Page -->
<div id="registry-container">
    <div class="admin-header">
        <h2 class="admin-title">Agent Registry (Master Classes)</h2>
        <div class="admin-actions">
            <div class="admin-search-box">
                <input type="text" id="profile-search" class="admin-search-input" placeholder="Search agents...">
            </div>
            <select id="registry-category-filter" class="admin-select" style="margin-right: 10px;">
                <option value="all">All Categories</option>
                <option value="Intelligence">Intelligence</option>
                <option value="Design">Design</option>
                <option value="Strategy">Strategy</option>
                <option value="QA">QA</option>
                <option value="Studio">Studio</option>
                <option value="Growth">Growth</option>
            </select>
            <button type="button" class="admin-btn-primary" onclick="openCreateAgentModal()"
                style="background: linear-gradient(135deg, #059669 0%, #047857 100%);">
                + Create New Agent
            </button>
            <button type="button" class="admin-btn-secondary" onclick="seedRegistry()" id="add-profile-btn">
                ğŸŒ± Seed Core Agents
            </button>
        </div>
    </div>

    <div class="admin-card">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Agent Name / ID</th>
                    <th>Category</th>
                    <th>Current Production</th>
                    <th>Status</th>
                    <th>Last Updated</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="profiles-table-body">
                <!-- Dynamically populated by admin-registry.js -->
                <tr>
                    <td colspan="6">Initializing...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Quick View Modal -->
<div id="agent-quick-view-modal" class="admin-modal" style="display: none;">
    <div class="admin-modal-content" style="max-width: 1000px; height: 90vh; display: flex; flex-direction: column;">
        <div class="admin-modal-header"
            style="background: linear-gradient(135deg, #1e3a5f 0%, #0d1b2a 100%); border-bottom: 1px solid rgba(255,255,255,0.1);">
            <div style="display: flex; align-items: center; gap: 12px;">
                <span id="qv-agent-icon" style="font-size: 24px;">ğŸ¤–</span>
                <div>
                    <h3 id="qv-agent-name" class="admin-modal-title" style="margin: 0;">Agent Name</h3>
                    <span id="qv-agent-id" style="font-size: 12px; color: rgba(255,255,255,0.5);"></span>
                </div>
            </div>
            <button class="admin-modal-close" onclick="closeQuickViewModal()">&times;</button>
        </div>

        <!-- Tab Navigation -->
        <div style="display: flex; gap: 0; background: #161b22; border-bottom: 1px solid #30363d;">
            <button id="qv-tab-prompt" class="qv-tab active" onclick="switchQuickViewTab('prompt')"
                style="flex: 1; padding: 12px 20px; background: transparent; border: none; color: #fff; cursor: pointer; border-bottom: 2px solid #4ecdc4; font-weight: 600;">
                ğŸ“ System Prompt
            </button>
            <button id="qv-tab-procedures" class="qv-tab" onclick="switchQuickViewTab('procedures')"
                style="flex: 1; padding: 12px 20px; background: transparent; border: none; color: rgba(255,255,255,0.6); cursor: pointer; border-bottom: 2px solid transparent;">
                ğŸ”„ Procedures
            </button>
            <button id="qv-tab-source" class="qv-tab" onclick="switchQuickViewTab('source')"
                style="flex: 1; padding: 12px 20px; background: transparent; border: none; color: rgba(255,255,255,0.6); cursor: pointer; border-bottom: 2px solid transparent;">
                ğŸ’» Source Code
            </button>
        </div>

        <div class="admin-modal-body" style="flex: 1; overflow: hidden; padding: 0; background: #0d1117;">
            <!-- Tab Content: Prompt -->
            <div id="qv-content-prompt" class="qv-content" style="height: 100%; overflow-y: auto; padding: 20px;">
                <div style="margin-bottom: 16px;">
                    <span
                        style="background: rgba(78, 205, 196, 0.2); color: #4ecdc4; padding: 4px 12px; border-radius: 12px; font-size: 12px;">
                        Production v<span id="qv-version">1.0.0</span>
                    </span>
                </div>
                <pre id="qv-prompt-content"
                    style="background: #161b22; padding: 20px; border-radius: 8px; white-space: pre-wrap; font-family: 'JetBrains Mono', monospace; font-size: 14px; color: #c9d1d9; line-height: 1.6; border: 1px solid #30363d;">Loading...</pre>
            </div>

            <!-- Tab Content: Procedures -->
            <div id="qv-content-procedures" class="qv-content"
                style="height: 100%; overflow-y: auto; padding: 20px; display: none;">
                <div id="qv-procedures-container" style="max-width: 500px; margin: 0 auto;"></div>
            </div>

            <!-- Tab Content: Source Code -->
            <div id="qv-content-source" class="qv-content"
                style="height: 100%; overflow-y: auto; padding: 20px; display: none;">
                <div style="margin-bottom: 16px; display: flex; gap: 8px; flex-wrap: wrap;" id="qv-source-files">
                    <!-- File buttons will be added here -->
                </div>
                <pre id="qv-source-content"
                    style="background: #161b22; padding: 20px; border-radius: 8px; white-space: pre-wrap; font-family: 'JetBrains Mono', monospace; font-size: 13px; color: #c9d1d9; line-height: 1.5; border: 1px solid #30363d; max-height: calc(100% - 60px); overflow-y: auto;">Select a source file above to view its contents.</pre>
            </div>
        </div>

        <div class="admin-modal-footer"
            style="background: #161b22; border-top: 1px solid #30363d; display: flex; justify-content: space-between;">
            <button type="button" class="admin-btn-secondary" onclick="closeQuickViewModal()">Close</button>
            <button type="button" class="admin-btn-primary" onclick="openAgentDetail()" id="qv-manage-btn">
                ğŸ“ Manage Versions
            </button>
        </div>
    </div>
</div>

<!-- Create New Agent Modal -->
<div id="create-agent-modal" class="admin-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99999; background: rgba(0,0,0,0.8); align-items: center; justify-content: center;">
    <div class="admin-modal-content" style="max-width: 900px; height: 95vh; display: flex; flex-direction: column;">
        <div class="admin-modal-header" style="background: linear-gradient(135deg, #059669 0%, #047857 100%);">
            <div>
                <h3 class="admin-modal-title">+ Create New Agent</h3>
                <span style="font-size: 12px; color: rgba(255,255,255,0.6);">Design a new AI agent from scratch</span>
            </div>
            <button class="admin-modal-close" onclick="closeCreateAgentModal()">&times;</button>
        </div>

        <!-- Tabs -->
        <div style="display: flex; background: #161b22; border-bottom: 1px solid #30363d;">
            <button class="create-tab active" id="create-tab-basic" onclick="switchCreateTab('basic')"
                style="flex: 1; padding: 12px; background: transparent; border: none; color: #fff; cursor: pointer; border-bottom: 2px solid #4ecdc4; font-weight: 600;">
                1ï¸âƒ£ Basic Info
            </button>
            <button class="create-tab" id="create-tab-prompt" onclick="switchCreateTab('prompt')"
                style="flex: 1; padding: 12px; background: transparent; border: none; color: rgba(255,255,255,0.6); cursor: pointer; border-bottom: 2px solid transparent;">
                2ï¸âƒ£ System Prompt
            </button>
            <button class="create-tab" id="create-tab-procedures" onclick="switchCreateTab('procedures')"
                style="flex: 1; padding: 12px; background: transparent; border: none; color: rgba(255,255,255,0.6); cursor: pointer; border-bottom: 2px solid transparent;">
                3ï¸âƒ£ Procedures
            </button>
        </div>

        <div class="admin-modal-body" style="flex: 1; overflow-y: auto; padding: 24px;">
            <!-- Tab 1: Basic Info -->
            <div id="create-content-basic" class="create-content">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="admin-form-group">
                        <label class="admin-form-label">Agent ID <span style="color: #ef4444;">*</span></label>
                        <input type="text" id="create-agent-id" class="admin-form-input"
                            placeholder="e.g. MKT-COPY-WRITER" style="text-transform: uppercase;">
                        <small style="color: rgba(255,255,255,0.4); font-size: 11px;">
                            Format: PREFIX-NAME (e.g. DSN-VISUAL, STG-PLANNER, GRW-ADS)
                        </small>
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label">Agent Name <span style="color: #ef4444;">*</span></label>
                        <input type="text" id="create-agent-name" class="admin-form-input"
                            placeholder="e.g. Marketing Copywriter">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 16px;">
                    <div class="admin-form-group">
                        <label class="admin-form-label">Category <span style="color: #ef4444;">*</span></label>
                        <select id="create-category" class="admin-select" style="width: 100%;">
                            <option value="Intelligence">Intelligence - ë°ì´í„° ë¶„ì„/ìˆ˜ì§‘</option>
                            <option value="Design">Design - ì½˜í…ì¸  ìƒì„±</option>
                            <option value="Strategy">Strategy - ì „ëµ ìˆ˜ë¦½</option>
                            <option value="QA">QA - í’ˆì§ˆ ê²€ì¦</option>
                            <option value="Studio">Studio - ìŠ¤íŠœë””ì˜¤ í†µí•©</option>
                            <option value="Growth">Growth - ì„±ì¥/ë§ˆì¼€íŒ…</option>
                        </select>
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label">LLM Model</label>
                        <select id="create-model" class="admin-select" style="width: 100%;">
                            <option value="deepseek-reasoner">DeepSeek R1 (Reasoner) - ê¶Œì¥</option>
                            <option value="deepseek-chat">DeepSeek V3</option>
                            <option value="gpt-4o">GPT-4o</option>
                            <option value="gpt-4o-mini">GPT-4o Mini</option>
                            <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                        </select>
                    </div>
                </div>

                <div class="admin-form-group" style="margin-top: 16px;">
                    <label class="admin-form-label">Description <span style="color: #ef4444;">*</span></label>
                    <textarea id="create-description" class="admin-form-input" rows="3"
                        placeholder="ì´ ì—ì´ì „íŠ¸ê°€ ë¬´ì—‡ì„ í•˜ëŠ”ì§€ ê°„ë‹¨íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”..."></textarea>
                </div>

                <div
                    style="background: rgba(59, 130, 246, 0.1); padding: 16px; border-radius: 8px; margin-top: 20px; border-left: 3px solid #3b82f6;">
                    <div style="font-size: 13px; color: #60a5fa;">
                        ğŸ’¡ <strong>Tip:</strong> Agent IDëŠ” ë‚˜ì¤‘ì— ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ëª…í™•í•˜ê³  ì¼ê´€ëœ ë„¤ì´ë°ì„ ì‚¬ìš©í•˜ì„¸ìš”.
                    </div>
                </div>
            </div>

            <!-- Tab 2: System Prompt -->
            <div id="create-content-prompt" class="create-content" style="display: none; height: 100%;">
                <div class="admin-form-group" style="height: 100%; display: flex; flex-direction: column;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <label class="admin-form-label" style="margin: 0;">System Prompt <span
                                style="color: #ef4444;">*</span></label>
                        <button class="admin-btn-secondary" style="font-size: 12px;" onclick="generatePromptWithAI()">
                            ğŸ¤– AIë¡œ ìƒì„±í•˜ê¸°
                        </button>
                    </div>
                    <textarea id="create-prompt" class="admin-form-input"
                        style="flex: 1; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.5; min-height: 350px;"
                        placeholder="You are [Agent Name], an AI agent specialized in...

Your responsibilities:
1. ...
2. ...

Input format:
- ...

Output format:
- ...

Guidelines:
- ..."></textarea>
                </div>
            </div>

            <!-- Tab 3: Procedures -->
            <div id="create-content-procedures" class="create-content" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <div>
                        <label class="admin-form-label" style="margin: 0;">Execution Procedures</label>
                        <small style="color: rgba(255,255,255,0.4); display: block; font-size: 11px; margin-top: 4px;">
                            ì—ì´ì „íŠ¸ê°€ ìˆ˜í–‰í•  ë‹¨ê³„ë¥¼ ì •ì˜í•©ë‹ˆë‹¤ (ì„ íƒ ì‚¬í•­)
                        </small>
                    </div>
                    <button class="admin-btn-secondary" style="font-size: 12px;" onclick="addNewProcedureStep()">
                        + Add Step
                    </button>
                </div>
                <div id="create-procedures-list" style="display: flex; flex-direction: column; gap: 12px;">
                    <!-- Dynamically populated -->
                    <div
                        style="text-align: center; padding: 40px; color: rgba(255,255,255,0.4); background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <p>ì•„ì§ ì •ì˜ëœ ë‹¨ê³„ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                        <button class="admin-btn-secondary" onclick="addNewProcedureStep()">+ Add First Step</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="admin-modal-footer"
            style="background: #161b22; border-top: 1px solid #30363d; display: flex; justify-content: space-between;">
            <button type="button" class="admin-btn-secondary" onclick="closeCreateAgentModal()">Cancel</button>
            <div style="display: flex; gap: 8px;">
                <button type="button" class="admin-btn-secondary" id="create-prev-btn" onclick="prevCreateTab()"
                    style="display: none;">
                    â† Previous
                </button>
                <button type="button" class="admin-btn-primary" id="create-next-btn" onclick="nextCreateTab()">
                    Next â†’
                </button>
                <button type="button" class="admin-btn-primary" id="create-submit-btn" onclick="submitNewAgent()"
                    style="display: none; background: linear-gradient(135deg, #059669 0%, #047857 100%);">
                    âœ… Create Agent
                </button>
            </div>
        </div>
    </div>
</div>